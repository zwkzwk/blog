<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css">























<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/blog/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="çº¿ç¨‹åŸºç¡€  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    çº¿ç¨‹ç®€ä»‹  ä»€ä¹ˆæ˜¯çº¿ç¨‹ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ   å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹  æ„é€ çº¿ç¨‹ ä¸­æ–­çº¿ç¨‹ ç»ˆæ­¢çº¿ç¨‹ Thread ä¸­çš„é‡è¦æ–¹æ³•   çº¿ç¨‹é—´é€šä¿¡  wait/notify/notifyAll çº¿ç¨‹çš„ç¤¼è®© ThreadLocal ç®¡é“è¾“å…¥/è¾“å‡ºæµ   FAQ  start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ">
<meta name="keywords" content="programming,javacore,java,concurrent,thread">
<meta property="og:type" content="article">
<meta property="og:title" content="çº¿ç¨‹åŸºç¡€">
<meta property="og:url" content="https://dunwu.github.io/2018/05/22/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€/index.html">
<meta property="og:site_name" content="å¼ é¹çš„åšå®¢">
<meta property="og:description" content="çº¿ç¨‹åŸºç¡€  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    çº¿ç¨‹ç®€ä»‹  ä»€ä¹ˆæ˜¯çº¿ç¨‹ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ   å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹  æ„é€ çº¿ç¨‹ ä¸­æ–­çº¿ç¨‹ ç»ˆæ­¢çº¿ç¨‹ Thread ä¸­çš„é‡è¦æ–¹æ³•   çº¿ç¨‹é—´é€šä¿¡  wait/notify/notifyAll çº¿ç¨‹çš„ç¤¼è®© ThreadLocal ç®¡é“è¾“å…¥/è¾“å‡ºæµ   FAQ  start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/dunwu/images/master/images/java/concurrent/thread-state.png">
<meta property="og:updated_time" content="2019-03-07T05:15:35.689Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="çº¿ç¨‹åŸºç¡€">
<meta name="twitter:description" content="çº¿ç¨‹åŸºç¡€  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    çº¿ç¨‹ç®€ä»‹  ä»€ä¹ˆæ˜¯çº¿ç¨‹ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ   å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹  æ„é€ çº¿ç¨‹ ä¸­æ–­çº¿ç¨‹ ç»ˆæ­¢çº¿ç¨‹ Thread ä¸­çš„é‡è¦æ–¹æ³•   çº¿ç¨‹é—´é€šä¿¡  wait/notify/notifyAll çº¿ç¨‹çš„ç¤¼è®© ThreadLocal ç®¡é“è¾“å…¥/è¾“å‡ºæµ   FAQ  start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ">
<meta name="twitter:image" content="https://raw.githubusercontent.com/dunwu/images/master/images/java/concurrent/thread-state.png">



  <link rel="alternate" href="/blog/atom.xml" title="å¼ é¹çš„åšå®¢" type="application/atom+xml">




  <link rel="canonical" href="https://dunwu.github.io/2018/05/22/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>çº¿ç¨‹åŸºç¡€ | å¼ é¹çš„åšå®¢</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å¼ é¹çš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/blog/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/blog/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

  <a href="https://github.com/dunwu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2018/05/22/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¼ é¹çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">çº¿ç¨‹åŸºç¡€<a href="https://github.com/dunwu/blog/blob/master/source/_posts/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€.md" class="post-edit-link" title="ç¼–è¾‘" rel="noopener" target="_blank"><i class="fa fa-pencil"></i></a>

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-05-22 16:20:00" itemprop="dateCreated datePublished" datetime="2018-05-22T16:20:00+08:00">2018-05-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-03-07 13:15:35" itemprop="dateModified" datetime="2019-03-07T13:15:35+08:00">2019-03-07</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/" itemprop="url" rel="index"><span itemprop="name">programming</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/javacore/" itemprop="url" rel="index"><span itemprop="name">javacore</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/javacore/concurrent/" itemprop="url" rel="index"><span itemprop="name">concurrent</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
                
                <span title="æœ¬æ–‡å­—æ•°">23k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">21 åˆ†é’Ÿ</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="çº¿ç¨‹åŸºç¡€"><a class="markdownIt-Anchor" href="#çº¿ç¨‹åŸºç¡€"></a> çº¿ç¨‹åŸºç¡€</h1>
<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E7%BA%BF%E7%A8%8B%E7%AE%80%E4%BB%8B">çº¿ç¨‹ç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B">ä»€ä¹ˆæ˜¯çº¿ç¨‹</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</a></li>
</ul>
</li>
<li><a href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E7%BB%88%E6%AD%A2%E7%BA%BF%E7%A8%8B">å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹</a>
<ul>
<li><a href="#%E6%9E%84%E9%80%A0%E7%BA%BF%E7%A8%8B">æ„é€ çº¿ç¨‹</a></li>
<li><a href="#%E4%B8%AD%E6%96%AD%E7%BA%BF%E7%A8%8B">ä¸­æ–­çº¿ç¨‹</a></li>
<li><a href="#%E7%BB%88%E6%AD%A2%E7%BA%BF%E7%A8%8B">ç»ˆæ­¢çº¿ç¨‹</a></li>
<li><a href="#thread-%E4%B8%AD%E7%9A%84%E9%87%8D%E8%A6%81%E6%96%B9%E6%B3%95">Thread ä¸­çš„é‡è¦æ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1">çº¿ç¨‹é—´é€šä¿¡</a>
<ul>
<li><a href="#waitnotifynotifyall">wait/notify/notifyAll</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%A4%BC%E8%AE%A9">çº¿ç¨‹çš„ç¤¼è®©</a></li>
<li><a href="#threadlocal">ThreadLocal</a></li>
<li><a href="#%E7%AE%A1%E9%81%93%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81">ç®¡é“è¾“å…¥/è¾“å‡ºæµ</a></li>
</ul>
</li>
<li><a href="#faq">FAQ</a>
<ul>
<li><a href="#start-%E5%92%8C-run-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8-thread-%E7%B1%BB%E7%9A%84-run-%E6%96%B9%E6%B3%95%E4%B9%88">start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ</a></li>
<li><a href="#sleepyieldjoin-%E6%96%B9%E6%B3%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%E4%B8%BA%E4%BB%80%E4%B9%88-sleep%E5%92%8C-yield%E6%96%B9%E6%B3%95%E6%98%AF%E9%9D%99%E6%80%81%E7%9A%84">sleep()ã€yield()ã€join() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆ sleep()å’Œ yield()æ–¹æ³•æ˜¯é™æ€çš„ï¼Ÿ</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88-sleep-%E5%92%8C-yield-%E6%96%B9%E6%B3%95%E6%98%AF%E9%9D%99%E6%80%81%E7%9A%84">ä¸ºä»€ä¹ˆ sleep() å’Œ yield() æ–¹æ³•æ˜¯é™æ€çš„</a></li>
<li><a href="#java-%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E5%A6%82%E4%BD%95%E6%8E%A7%E5%88%B6%E9%AB%98%E4%BC%98%E5%85%88%E7%BA%A7%E7%9A%84-java-%E7%BA%BF%E7%A8%8B%E4%B8%80%E5%AE%9A%E5%85%88%E6%89%A7%E8%A1%8C%E5%90%97">Java çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶ï¼Ÿé«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—ï¼Ÿ</a></li>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B">ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Ÿå¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1%E7%9A%84%E6%96%B9%E6%B3%95-wait-notify%E5%92%8C-notifyall%E8%A2%AB%E5%AE%9A%E4%B9%89%E5%9C%A8-object-%E7%B1%BB%E9%87%8C">ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait(), notify()å’Œ notifyAll()è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88-wait-notify%E5%92%8C-notifyall%E5%BF%85%E9%A1%BB%E5%9C%A8%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%E6%88%96%E8%80%85%E5%90%8C%E6%AD%A5%E5%9D%97%E4%B8%AD%E8%A2%AB%E8%B0%83%E7%94%A8">ä¸ºä»€ä¹ˆ wait(), notify()å’Œ notifyAll()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%96%99">èµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="çº¿ç¨‹ç®€ä»‹"><a class="markdownIt-Anchor" href="#çº¿ç¨‹ç®€ä»‹"></a> çº¿ç¨‹ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹"></a> ä»€ä¹ˆæ˜¯çº¿ç¨‹</h3>
<p>ç°ä»£æ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒæ˜¯çº¿ç¨‹ï¼Œä¹Ÿå«è½»é‡çº§è¿›ç¨‹ï¼ˆLight Weight Processï¼‰ï¼Œåœ¨ä¸€ä¸ªè¿›ç¨‹é‡Œå¯ä»¥åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹éƒ½æ‹¥æœ‰å„è‡ªçš„è®¡æ•°å™¨ã€å †æ ˆå’Œå±€éƒ¨å˜é‡ç­‰å±æ€§ï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¿é—®å…±äº«çš„å†…å­˜å˜é‡ã€‚</p>
<h3 id="çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ"><a class="markdownIt-Anchor" href="#çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ"></a> çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</h3>
<p align="center">
  <img src="https://raw.githubusercontent.com/dunwu/images/master/images/java/concurrent/thread-state.png">
</p>
<p><code>java.lang.Thread.State</code> ä¸­å®šä¹‰äº† <strong>6</strong> ç§ä¸åŒçš„çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ç»™å®šçš„ä¸€ä¸ªæ—¶åˆ»ï¼Œçº¿ç¨‹åªèƒ½å¤„äºå…¶ä¸­çš„ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å„çŠ¶æ€çš„è¯´æ˜ï¼Œä»¥åŠçŠ¶æ€é—´çš„è”ç³»ï¼š</p>
<ul>
<li><strong>å¼€å§‹ï¼ˆNewï¼‰</strong> - è¿˜æ²¡æœ‰è°ƒç”¨ <code>start()</code> æ–¹æ³•çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚</li>
<li><strong>å¯è¿è¡Œï¼ˆRunnableï¼‰</strong> - å·²ç»è°ƒç”¨äº† <code>start()</code> æ–¹æ³•çš„çº¿ç¨‹çŠ¶æ€ã€‚æ­¤çŠ¶æ€æ„å‘³ç€ï¼Œçº¿ç¨‹å·²ç»å‡†å¤‡å¥½äº†ï¼Œä¸€æ—¦è¢«çº¿ç¨‹è°ƒåº¦å™¨åˆ†é…äº† CPU æ—¶é—´ç‰‡ï¼Œå°±å¯ä»¥è¿è¡Œçº¿ç¨‹ã€‚</li>
<li><strong>é˜»å¡ï¼ˆBlockedï¼‰</strong> - é˜»å¡çŠ¶æ€ã€‚çº¿ç¨‹é˜»å¡çš„çº¿ç¨‹çŠ¶æ€ç­‰å¾…ç›‘è§†å™¨é”å®šã€‚å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹æ­£åœ¨ç­‰å¾…ç›‘è§†å™¨é”å®šï¼Œä»¥ä¾¿åœ¨è°ƒç”¨ <code>Object.wait()</code> ä¹‹åè¾“å…¥åŒæ­¥å—/æ–¹æ³•æˆ–é‡æ–°è¾“å…¥åŒæ­¥å—/æ–¹æ³•ã€‚</li>
<li><strong>ç­‰å¾…ï¼ˆWaitingï¼‰</strong> - ç­‰å¾…çŠ¶æ€ã€‚ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œæ˜¯ç”±äºæ‰§è¡Œäº† 3 ä¸ªæ–¹æ³•ä¸­çš„ä»»æ„æ–¹æ³•ï¼š
<ul>
<li><code>Object.wait()</code></li>
<li><code>Thread.join()</code></li>
<li><code>LockSupport.park()</code></li>
</ul>
</li>
<li><strong>å®šæ—¶ç­‰å¾…ï¼ˆTimed waitingï¼‰</strong> - ç­‰å¾…æŒ‡å®šæ—¶é—´çš„çŠ¶æ€ã€‚ä¸€ä¸ªçº¿ç¨‹å¤„äºå®šæ—¶ç­‰å¾…çŠ¶æ€ï¼Œæ˜¯ç”±äºæ‰§è¡Œäº†ä»¥ä¸‹æ–¹æ³•ä¸­çš„ä»»æ„æ–¹æ³•ï¼š
<ul>
<li><code>Thread.sleep(sleeptime)</code></li>
<li><code>Object.wait(timeout)</code></li>
<li><code>Thread.join(timeout)</code></li>
<li><code>LockSupport.parkNanos(timeout)</code></li>
<li><code>LockSupport.parkUntil(timeout)</code></li>
</ul>
</li>
<li><strong>ç»ˆæ­¢(Terminated)</strong> - çº¿ç¨‹ <code>run()</code> æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† <code>run()</code> æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚</li>
</ul>
<h2 id="å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹"><a class="markdownIt-Anchor" href="#å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹"></a> å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹</h2>
<h3 id="æ„é€ çº¿ç¨‹"><a class="markdownIt-Anchor" href="#æ„é€ çº¿ç¨‹"></a> æ„é€ çº¿ç¨‹</h3>
<p>æ„é€ çº¿ç¨‹ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼</p>
<ul>
<li>ç»§æ‰¿ <code>Thread</code> ç±»</li>
<li>å®ç° <code>Runnable</code> æ¥å£</li>
<li>å®ç° <code>Callable</code> æ¥å£</li>
</ul>
<h4 id="ç»§æ‰¿-thread-ç±»"><a class="markdownIt-Anchor" href="#ç»§æ‰¿-thread-ç±»"></a> ç»§æ‰¿ Thread ç±»</h4>
<p>é€šè¿‡ç»§æ‰¿ Thread ç±»æ„é€ çº¿ç¨‹çš„æ­¥éª¤ï¼š</p>
<ul>
<li>å®šä¹‰ Thread ç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„ run() æ–¹æ³•ï¼Œè¯¥ run() æ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹è¦å®Œæˆçš„ä»»åŠ¡ã€‚å› æ­¤æŠŠ run() æ–¹æ³•ç§°ä¸ºæ‰§è¡Œä½“ã€‚</li>
<li>åˆ›å»º Thread å­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo02</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread02 mt1 = <span class="keyword">new</span> Thread02(<span class="string">"çº¿ç¨‹A "</span>); <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        Thread02 mt2 = <span class="keyword">new</span> Thread02(<span class="string">"çº¿ç¨‹B "</span>); <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        mt1.start(); <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">        mt2.start(); <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread02</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">        Thread02(String name) &#123;</span><br><span class="line">            <span class="keyword">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(<span class="keyword">this</span>.getName() + <span class="string">" å–ç¥¨ï¼šticket = "</span> + ticket--);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å®ç°-runnable-æ¥å£"><a class="markdownIt-Anchor" href="#å®ç°-runnable-æ¥å£"></a> å®ç° Runnable æ¥å£</h4>
<p>é€šè¿‡å®ç° Runnable æ¥å£æ„é€ çº¿ç¨‹çš„æ­¥éª¤ï¼š</p>
<ul>
<li>å®šä¹‰ Runnable æ¥å£çš„å®ç°ç±»ï¼Œå¹¶é‡å†™è¯¥æ¥å£çš„ run() æ–¹æ³•ï¼Œè¯¥ run() æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</li>
<li>åˆ›å»º Runnable å®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä¾æ­¤å®ä¾‹ä½œä¸º Thread çš„ target æ¥åˆ›å»º Thread å¯¹è±¡ï¼Œè¯¥ Thread å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ start() æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunnableDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t = <span class="keyword">new</span> MyThread(<span class="string">"Runnable çº¿ç¨‹"</span>); <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">new</span> Thread(t).run(); <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">        <span class="keyword">new</span> Thread(t).run(); <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">        <span class="keyword">new</span> Thread(t).run(); <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">        MyThread(String name) &#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(<span class="keyword">this</span>.name + <span class="string">" å–ç¥¨ï¼šticket = "</span> + ticket--);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å®ç°-callable-æ¥å£"><a class="markdownIt-Anchor" href="#å®ç°-callable-æ¥å£"></a> å®ç° Callable æ¥å£</h4>
<p>é€šè¿‡å®ç° Callable æ¥å£æ„é€ çº¿ç¨‹çš„æ­¥éª¤ï¼š</p>
<ul>
<li>åˆ›å»º Callable æ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç° call() æ–¹æ³•ï¼Œè¯¥ call() æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ã€‚</li>
<li>åˆ›å»º Callable å®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨ FutureTask ç±»æ¥åŒ…è£… Callable å¯¹è±¡ï¼Œè¯¥ FutureTask å¯¹è±¡å°è£…äº†è¯¥ Callable å¯¹è±¡çš„ call() æ–¹æ³•çš„è¿”å›å€¼ã€‚</li>
<li>ä½¿ç”¨ FutureTask å¯¹è±¡ä½œä¸º Thread å¯¹è±¡çš„ target åˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚</li>
<li>è°ƒç”¨ FutureTask å¯¹è±¡çš„ get() æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallableAndFutureDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Callable&lt;Integer&gt; callable = () -&gt; <span class="keyword">new</span> Random().nextInt(<span class="number">100</span>);</span><br><span class="line">        FutureTask&lt;Integer&gt; future = <span class="keyword">new</span> FutureTask&lt;&gt;(callable);</span><br><span class="line">        <span class="keyword">new</span> Thread(future).start();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);<span class="comment">// å¯èƒ½åšä¸€äº›äº‹æƒ…</span></span><br><span class="line">            System.out.println(future.get());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ–¹å¼å¯¹æ¯”"><a class="markdownIt-Anchor" href="#ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ–¹å¼å¯¹æ¯”"></a> ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ–¹å¼å¯¹æ¯”</h4>
<ul>
<li><strong>å®ç° Runnable æ¥å£ä¼˜äºç»§æ‰¿ Thread ç±»</strong>ï¼Œå› ä¸ºå®ç°æ¥å£æ–¹å¼æ›´ä¾¿äºæ‰©å±•ç±»ã€‚</li>
<li>å®ç° Runnable æ¥å£çš„çº¿ç¨‹æ²¡æœ‰è¿”å›å€¼ï¼›è€Œ<strong>å®ç° Callable æ¥å£çš„çº¿ç¨‹æœ‰è¿”å›å€¼</strong>ã€‚</li>
</ul>
<h3 id="ä¸­æ–­çº¿ç¨‹"><a class="markdownIt-Anchor" href="#ä¸­æ–­çº¿ç¨‹"></a> ä¸­æ–­çº¿ç¨‹</h3>
<p>å½“ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç›´æ¥é€šè¿‡ <code>interrupt()</code> æ–¹æ³•ä¸­æ–­å…¶è¿è¡ŒçŠ¶æ€ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadInterruptDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread mt = <span class="keyword">new</span> MyThread(); <span class="comment">// å®ä¾‹åŒ–Runnableå­ç±»å¯¹è±¡</span></span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(mt, <span class="string">"çº¿ç¨‹"</span>); <span class="comment">// å®ä¾‹åŒ–Threadå¯¹è±¡</span></span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>); <span class="comment">// çº¿ç¨‹ä¼‘çœ 2ç§’</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"3ã€ä¼‘çœ è¢«ç»ˆæ­¢"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        t.interrupt(); <span class="comment">// ä¸­æ–­çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"1ã€è¿›å…¥run()æ–¹æ³•"</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">10000</span>); <span class="comment">// çº¿ç¨‹ä¼‘çœ 10ç§’</span></span><br><span class="line">                System.out.println(<span class="string">"2ã€å·²ç»å®Œæˆäº†ä¼‘çœ "</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                System.out.println(<span class="string">"3ã€ä¼‘çœ è¢«ç»ˆæ­¢"</span>);</span><br><span class="line">                <span class="keyword">return</span>; <span class="comment">// è¿”å›è°ƒç”¨å¤„</span></span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"4ã€run()æ–¹æ³•æ­£å¸¸ç»“æŸ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç»ˆæ­¢çº¿ç¨‹"><a class="markdownIt-Anchor" href="#ç»ˆæ­¢çº¿ç¨‹"></a> ç»ˆæ­¢çº¿ç¨‹</h3>
<p>Thread ä¸­çš„ stop æ–¹æ³•æœ‰ç¼ºé™·ï¼Œå·²åºŸå¼ƒã€‚</p>
<p>å®‰å…¨åœ°ç»ˆæ­¢çº¿ç¨‹æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>ä¸­æ–­çŠ¶æ€æ˜¯çº¿ç¨‹çš„ä¸€ä¸ªæ ‡è¯†ä½ï¼Œè€Œä¸­æ–­æ“ä½œæ˜¯ä¸€ç§ç®€ä¾¿çš„çº¿ç¨‹é—´äº¤äº’æ–¹å¼ï¼Œè€Œè¿™ç§äº¤äº’æ–¹å¼æœ€é€‚åˆç”¨æ¥å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ã€‚</li>
<li>è¿˜å¯ä»¥åˆ©ç”¨ä¸€ä¸ª boolean å˜é‡æ¥æ§åˆ¶æ˜¯å¦éœ€è¦åœæ­¢ä»»åŠ¡å¹¶ç»ˆæ­¢è¯¥çº¿ç¨‹ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadStopDemo03</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MyTask one = <span class="keyword">new</span> MyTask();</span><br><span class="line">        Thread countThread = <span class="keyword">new</span> Thread(one, <span class="string">"CountThread"</span>);</span><br><span class="line">        countThread.start();</span><br><span class="line">        <span class="comment">// ç¡çœ 1ç§’ï¼Œmainçº¿ç¨‹å¯¹CountThreadè¿›è¡Œä¸­æ–­ï¼Œä½¿CountThreadèƒ½å¤Ÿæ„ŸçŸ¥ä¸­æ–­è€Œç»“æŸ</span></span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        countThread.interrupt();</span><br><span class="line">        MyTask two = <span class="keyword">new</span> MyTask();</span><br><span class="line">        countThread = <span class="keyword">new</span> Thread(two, <span class="string">"CountThread"</span>);</span><br><span class="line">        countThread.start();</span><br><span class="line">        <span class="comment">// ç¡çœ 1ç§’ï¼Œmainçº¿ç¨‹å¯¹Runner twoè¿›è¡Œå–æ¶ˆï¼Œä½¿CountThreadèƒ½å¤Ÿæ„ŸçŸ¥onä¸ºfalseè€Œç»“æŸ</span></span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        two.cancel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTask</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">long</span> i;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> on = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (on &amp;&amp; !Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"Count i = "</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">cancel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            on = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="thread-ä¸­çš„é‡è¦æ–¹æ³•"><a class="markdownIt-Anchor" href="#thread-ä¸­çš„é‡è¦æ–¹æ³•"></a> Thread ä¸­çš„é‡è¦æ–¹æ³•</h3>
<ul>
<li><code>run</code> - çº¿ç¨‹çš„æ‰§è¡Œå®ä½“ã€‚</li>
<li><code>start</code> - çº¿ç¨‹çš„å¯åŠ¨æ–¹æ³•ã€‚</li>
<li><code>setName</code>ã€<code>getName</code> - å¯ä»¥é€šè¿‡ setName()ã€ getName() æ¥è®¾ç½®ã€è·å–çº¿ç¨‹åç§°ã€‚</li>
<li><code>setPriority</code>ã€<code>getPriority</code> - åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çº¿ç¨‹åœ¨è¿è¡Œå‰éƒ½ä¼šä¿æŒåœ¨å°±ç»ªçŠ¶æ€ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå“ªä¸ªçº¿ç¨‹ä¼˜å…ˆçº§é«˜ï¼Œå“ªä¸ªçº¿ç¨‹å°±æœ‰å¯èƒ½è¢«å…ˆæ‰§è¡Œã€‚å¯ä»¥é€šè¿‡ setPriorityã€getPriority æ¥è®¾ç½®ã€è·å–çº¿ç¨‹ä¼˜å…ˆçº§ã€‚</li>
<li><code>setDaemon</code>ã€<code>isDaemon</code> - å¯ä»¥ä½¿ç”¨ setDaemon() æ–¹æ³•è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼›å¯ä»¥ä½¿ç”¨ isDaemon() æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li><code>isAlive</code> - å¯ä»¥é€šè¿‡ isAlive æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨ã€‚</li>
<li><code>interrupt</code> - å½“ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç›´æ¥é€šè¿‡ interrupt() æ–¹æ³•ä¸­æ–­å…¶è¿è¡ŒçŠ¶æ€ã€‚</li>
<li><code>join</code> - ä½¿ç”¨ join() æ–¹æ³•è®©ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</li>
<li><code>Thread.sleep</code> - ä½¿ç”¨ Thread.sleep() æ–¹æ³•å³å¯å®ç°ä¼‘çœ ã€‚</li>
<li><code>Thread.yield</code> - å¯ä»¥ä½¿ç”¨ Thread.yield() æ–¹æ³•å°†ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œæš‚æ—¶è®©ç»™å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚</li>
</ul>
<h4 id="è®¾ç½®è·å–çº¿ç¨‹åç§°"><a class="markdownIt-Anchor" href="#è®¾ç½®è·å–çº¿ç¨‹åç§°"></a> è®¾ç½®/è·å–çº¿ç¨‹åç§°</h4>
<p>åœ¨ Thread ç±»ä¸­å¯ä»¥é€šè¿‡ <code>setName()</code>ã€ <code>getName()</code> æ¥è®¾ç½®ã€è·å–çº¿ç¨‹åç§°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadNameDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread mt = <span class="keyword">new</span> MyThread(); <span class="comment">// å®ä¾‹åŒ–Runnableå­ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">new</span> Thread(mt).start(); <span class="comment">// ç³»ç»Ÿè‡ªåŠ¨è®¾ç½®çº¿ç¨‹åç§°</span></span><br><span class="line">        <span class="keyword">new</span> Thread(mt, <span class="string">"çº¿ç¨‹-A"</span>).start(); <span class="comment">// æ‰‹å·¥è®¾ç½®çº¿ç¨‹åç§°</span></span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(mt); <span class="comment">// æ‰‹å·¥è®¾ç½®çº¿ç¨‹åç§°</span></span><br><span class="line">        t.setName(<span class="string">"çº¿ç¨‹-B"</span>);</span><br><span class="line">        t.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">"è¿è¡Œï¼Œi = "</span> + i); <span class="comment">// å–å¾—å½“å‰çº¿ç¨‹çš„åå­—</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨"><a class="markdownIt-Anchor" href="#åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨"></a> åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨</h4>
<p>åœ¨ Thread ç±»ä¸­å¯ä»¥é€šè¿‡ <code>isAlive()</code> æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadAliveDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread mt = <span class="keyword">new</span> MyThread(); <span class="comment">// å®ä¾‹åŒ–Runnableå­ç±»å¯¹è±¡</span></span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(mt, <span class="string">"çº¿ç¨‹"</span>); <span class="comment">// å®ä¾‹åŒ–Threadå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">"çº¿ç¨‹å¼€å§‹æ‰§è¡Œä¹‹å‰ --&gt; "</span> + t.isAlive()); <span class="comment">// åˆ¤æ–­æ˜¯å¦å¯åŠ¨</span></span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        System.out.println(<span class="string">"çº¿ç¨‹å¼€å§‹æ‰§è¡Œä¹‹å --&gt; "</span> + t.isAlive()); <span class="comment">// åˆ¤æ–­æ˜¯å¦å¯åŠ¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">" mainè¿è¡Œ --&gt; "</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»¥ä¸‹çš„è¾“å‡ºç»“æœä¸ç¡®å®š</span></span><br><span class="line">        System.out.println(<span class="string">"ä»£ç æ‰§è¡Œä¹‹å --&gt; "</span> + t.isAlive()); <span class="comment">// åˆ¤æ–­æ˜¯å¦å¯åŠ¨</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">"è¿è¡Œï¼Œi = "</span> + i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å®ˆæŠ¤çº¿ç¨‹"><a class="markdownIt-Anchor" href="#å®ˆæŠ¤çº¿ç¨‹"></a> å®ˆæŠ¤çº¿ç¨‹</h4>
<p>åœ¨ Java ç¨‹åºä¸­ï¼Œåªè¦å‰å°æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œåˆ™æ•´ä¸ª Java è¿›ç¨‹å°±ä¸ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥æ­¤æ—¶å¯ä»¥è®¾ç½®ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ï¼Œè¿™æ ·å³ä½¿ Java è¿›ç¨‹ç»“æŸäº†ï¼Œæ­¤å®ˆæŠ¤çº¿ç¨‹ä¾ç„¶ä¼šç»§ç»­æ‰§è¡Œã€‚å¯ä»¥ä½¿ç”¨ <code>setDaemon()</code> æ–¹æ³•è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼›å¯ä»¥ä½¿ç”¨ <code>isDaemon()</code> æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDaemonDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(), <span class="string">"çº¿ç¨‹"</span>);</span><br><span class="line">        t.setDaemon(<span class="keyword">true</span>); <span class="comment">// æ­¤çº¿ç¨‹åœ¨åå°è¿è¡Œ</span></span><br><span class="line">        System.out.println(<span class="string">"çº¿ç¨‹ t æ˜¯å¦æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼š"</span> + t.isDaemon());</span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">"åœ¨è¿è¡Œã€‚"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è®¾ç½®è·å–çº¿ç¨‹ä¼˜å…ˆçº§"><a class="markdownIt-Anchor" href="#è®¾ç½®è·å–çº¿ç¨‹ä¼˜å…ˆçº§"></a> è®¾ç½®/è·å–çº¿ç¨‹ä¼˜å…ˆçº§</h4>
<p>åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çº¿ç¨‹åœ¨è¿è¡Œå‰éƒ½ä¼šä¿æŒåœ¨å°±ç»ªçŠ¶æ€ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå“ªä¸ªçº¿ç¨‹ä¼˜å…ˆçº§é«˜ï¼Œå“ªä¸ªçº¿ç¨‹å°±æœ‰å¯èƒ½è¢«å…ˆæ‰§è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPriorityDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¸»æ–¹æ³•çš„ä¼˜å…ˆçº§ï¼š"</span> + Thread.currentThread().getPriority());</span><br><span class="line">        System.out.println(<span class="string">"MAX_PRIORITY = "</span> + Thread.MAX_PRIORITY);</span><br><span class="line">        System.out.println(<span class="string">"NORM_PRIORITY = "</span> + Thread.NORM_PRIORITY);</span><br><span class="line">        System.out.println(<span class="string">"MIN_PRIORITY = "</span> + Thread.MIN_PRIORITY);</span><br><span class="line"></span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(), <span class="string">"çº¿ç¨‹A"</span>); <span class="comment">// å®ä¾‹åŒ–çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(), <span class="string">"çº¿ç¨‹B"</span>); <span class="comment">// å®ä¾‹åŒ–çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">        Thread t3 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(), <span class="string">"çº¿ç¨‹C"</span>); <span class="comment">// å®ä¾‹åŒ–çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">        t1.setPriority(Thread.MIN_PRIORITY); <span class="comment">// ä¼˜å…ˆçº§æœ€ä½</span></span><br><span class="line">        t2.setPriority(Thread.MAX_PRIORITY); <span class="comment">// ä¼˜å…ˆçº§æœ€ä½</span></span><br><span class="line">        t3.setPriority(Thread.NORM_PRIORITY); <span class="comment">// ä¼˜å…ˆçº§æœ€ä½</span></span><br><span class="line">        t1.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        t2.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        t3.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>); <span class="comment">// çº¿ç¨‹ä¼‘çœ </span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å–å¾—å½“å‰çº¿ç¨‹çš„åå­—</span></span><br><span class="line">                String out =</span><br><span class="line">                    Thread.currentThread().getName() + <span class="string">"ï¼Œä¼˜å…ˆçº§ï¼š"</span> + Thread.currentThread().getPriority() + <span class="string">"ï¼Œè¿è¡Œï¼ši = "</span> + i;</span><br><span class="line">                System.out.println(out);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="çº¿ç¨‹é—´é€šä¿¡"><a class="markdownIt-Anchor" href="#çº¿ç¨‹é—´é€šä¿¡"></a> çº¿ç¨‹é—´é€šä¿¡</h2>
<h3 id="waitnotifynotifyall"><a class="markdownIt-Anchor" href="#waitnotifynotifyall"></a> wait/notify/notifyAll</h3>
<p>waitã€notifyã€notifyAll æ˜¯ Object ç±»ä¸­çš„æ–¹æ³•ã€‚</p>
<ul>
<li><code>wait</code> - çº¿ç¨‹è‡ªåŠ¨é‡Šæ”¾å…¶å æœ‰çš„å¯¹è±¡é”ï¼Œå¹¶ç­‰å¾… notifyã€‚</li>
<li><code>notify</code> - å”¤é†’ä¸€ä¸ªæ­£åœ¨ wait å½“å‰å¯¹è±¡é”çš„çº¿ç¨‹ï¼Œå¹¶è®©å®ƒæ‹¿åˆ°å¯¹è±¡é”ã€‚</li>
<li><code>notifyAll</code> - å”¤é†’æ‰€æœ‰æ­£åœ¨ wait å‰å¯¹è±¡é”çš„çº¿ç¨‹ã€‚</li>
</ul>
<p>ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadWaitNotifyDemo02</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> QUEUE_SIZE = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> PriorityQueue&lt;Integer&gt; queue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(QUEUE_SIZE);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Producer(<span class="string">"ç”Ÿäº§è€…A"</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Producer(<span class="string">"ç”Ÿäº§è€…B"</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Consumer(<span class="string">"æ¶ˆè´¹è€…A"</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Consumer(<span class="string">"æ¶ˆè´¹è€…B"</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Consumer(String name) &#123;</span><br><span class="line">            <span class="keyword">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (queue) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (queue.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            System.out.println(<span class="string">"é˜Ÿåˆ—ç©ºï¼Œç­‰å¾…æ•°æ®"</span>);</span><br><span class="line">                            queue.wait();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                            queue.notifyAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    queue.poll(); <span class="comment">// æ¯æ¬¡ç§»èµ°é˜Ÿé¦–å…ƒç´ </span></span><br><span class="line">                    queue.notifyAll();</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">" ä»é˜Ÿåˆ—å–èµ°ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š"</span> + queue.size() + <span class="string">"ä¸ªå…ƒç´ "</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Producer(String name) &#123;</span><br><span class="line">            <span class="keyword">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (queue) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (queue.size() == QUEUE_SIZE) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            System.out.println(<span class="string">"é˜Ÿåˆ—æ»¡ï¼Œç­‰å¾…æœ‰ç©ºä½™ç©ºé—´"</span>);</span><br><span class="line">                            queue.wait();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                            queue.notifyAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    queue.offer(<span class="number">1</span>); <span class="comment">// æ¯æ¬¡æ’å…¥ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">                    queue.notifyAll();</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">" å‘é˜Ÿåˆ—å–ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š"</span> + queue.size() + <span class="string">"ä¸ªå…ƒç´ "</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="çº¿ç¨‹çš„ç¤¼è®©"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„ç¤¼è®©"></a> çº¿ç¨‹çš„ç¤¼è®©</h3>
<p>åœ¨çº¿ç¨‹æ“ä½œä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>Thread.yield()</code> æ–¹æ³•å°†ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œæš‚æ—¶è®©ç»™å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadYieldDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t = <span class="keyword">new</span> MyThread();</span><br><span class="line">        <span class="keyword">new</span> Thread(t, <span class="string">"çº¿ç¨‹A"</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(t, <span class="string">"çº¿ç¨‹B"</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">"è¿è¡Œï¼Œi = "</span> + i);</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">2</span>) &#123;</span><br><span class="line">                    System.out.print(<span class="string">"çº¿ç¨‹ç¤¼è®©ï¼š"</span>);</span><br><span class="line">                    Thread.yield();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="çº¿ç¨‹çš„å¼ºåˆ¶æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„å¼ºåˆ¶æ‰§è¡Œ"></a> çº¿ç¨‹çš„å¼ºåˆ¶æ‰§è¡Œ</h4>
<p>åœ¨çº¿ç¨‹æ“ä½œä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>join()</code> æ–¹æ³•è®©ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadJoinDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread mt = <span class="keyword">new</span> MyThread(); <span class="comment">// å®ä¾‹åŒ–Runnableå­ç±»å¯¹è±¡</span></span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(mt, <span class="string">"mythread"</span>); <span class="comment">// å®ä¾‹åŒ–Threadå¯¹è±¡</span></span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    t.join(); <span class="comment">// çº¿ç¨‹å¼ºåˆ¶è¿è¡Œ</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"Main çº¿ç¨‹è¿è¡Œ --&gt; "</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">" è¿è¡Œï¼Œi = "</span> + i); <span class="comment">// å–å¾—å½“å‰çº¿ç¨‹çš„åå­—</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="çº¿ç¨‹çš„ä¼‘çœ "><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„ä¼‘çœ "></a> çº¿ç¨‹çš„ä¼‘çœ </h4>
<p>ç›´æ¥ä½¿ç”¨ <code>Thread.sleep()</code> æ–¹æ³•å³å¯å®ç°ä¼‘çœ ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadSleepDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(<span class="string">"çº¿ç¨‹A"</span>, <span class="number">1000</span>)).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(<span class="string">"çº¿ç¨‹A"</span>, <span class="number">2000</span>)).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyThread(<span class="string">"çº¿ç¨‹A"</span>, <span class="number">3000</span>)).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> time;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">MyThread</span><span class="params">(String name, <span class="keyword">int</span> time)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name; <span class="comment">// è®¾ç½®çº¿ç¨‹åç§°</span></span><br><span class="line">            <span class="keyword">this</span>.time = time; <span class="comment">// è®¾ç½®ä¼‘çœ æ—¶é—´</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="keyword">this</span>.time); <span class="comment">// ä¼‘çœ æŒ‡å®šçš„æ—¶é—´</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">"çº¿ç¨‹ï¼Œä¼‘çœ "</span> + <span class="keyword">this</span>.time + <span class="string">"æ¯«ç§’ã€‚"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="threadlocal"><a class="markdownIt-Anchor" href="#threadlocal"></a> ThreadLocal</h3>
<p>ThreadLocalï¼Œå¾ˆå¤šåœ°æ–¹å«åšçº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œä¹Ÿæœ‰äº›åœ°æ–¹å«åšçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼Œå…¶å®æ„æ€å·®ä¸å¤šã€‚å¯èƒ½å¾ˆå¤šæœ‹å‹éƒ½çŸ¥é“ ThreadLocal ä¸ºå˜é‡åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­éƒ½åˆ›å»ºäº†ä¸€ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®è‡ªå·±å†…éƒ¨çš„å‰¯æœ¬å˜é‡ã€‚</p>
<h4 id="æºç "><a class="markdownIt-Anchor" href="#æºç "></a> æºç </h4>
<p>ThreadLocal çš„ä¸»è¦æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocal</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;S&gt; <span class="function">ThreadLocal&lt;S&gt; <span class="title">withInitial</span><span class="params">(Supplier&lt;? extends S&gt; supplier)</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>get()æ–¹æ³•æ˜¯ç”¨æ¥è·å– ThreadLocal åœ¨å½“å‰çº¿ç¨‹ä¸­ä¿å­˜çš„å˜é‡å‰¯æœ¬ã€‚</li>
<li>set()ç”¨æ¥è®¾ç½®å½“å‰çº¿ç¨‹ä¸­å˜é‡çš„å‰¯æœ¬ã€‚</li>
<li>remove()ç”¨æ¥ç§»é™¤å½“å‰çº¿ç¨‹ä¸­å˜é‡çš„å‰¯æœ¬ã€‚</li>
<li>initialValue()æ˜¯ä¸€ä¸ª protected æ–¹æ³•ï¼Œä¸€èˆ¬æ˜¯ç”¨æ¥åœ¨ä½¿ç”¨æ—¶è¿›è¡Œé‡å†™çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªå»¶è¿ŸåŠ è½½æ–¹æ³•ï¼Œä¸‹é¢ä¼šè¯¦ç»†è¯´æ˜ã€‚</li>
</ul>
<h5 id="get-æºç å®ç°"><a class="markdownIt-Anchor" href="#get-æºç å®ç°"></a> get() æºç å®ç°</h5>
<p><strong>get æºç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>) &#123;</span><br><span class="line">        ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">            T result = (T)e.value;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> setInitialValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>å–å¾—å½“å‰çº¿ç¨‹ã€‚</li>
<li>é€šè¿‡ getMap() æ–¹æ³•è·å– ThreadLocalMapã€‚</li>
<li>æˆåŠŸï¼Œè¿”å› valueï¼›å¤±è´¥ï¼Œè¿”å› setInitialValue()ã€‚</li>
</ol>
<h5 id="threadlocalmap-æºç å®ç°"><a class="markdownIt-Anchor" href="#threadlocalmap-æºç å®ç°"></a> ThreadLocalMap æºç å®ç°</h5>
<p><strong>ThreadLocalMap æºç </strong></p>
<p>ThreadLocalMap æ˜¯ ThreadLocal çš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚</p>
<p>ThreadLocalMap çš„ Entry ç»§æ‰¿äº† WeakReferenceï¼Œå¹¶ä¸”ä½¿ç”¨ ThreadLocal ä½œä¸ºé”®å€¼ã€‚</p>
<h5 id="setinitialvalue-æºç å®ç°"><a class="markdownIt-Anchor" href="#setinitialvalue-æºç å®ç°"></a> setInitialValue æºç å®ç°</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> T <span class="title">setInitialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T value = initialValue();</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">        map.set(<span class="keyword">this</span>, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        createMap(t, value);</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ map ä¸ä¸ºç©ºï¼Œå°±è®¾ç½®é”®å€¼å¯¹ï¼›ä¸ºç©ºï¼Œå†åˆ›å»º Mapï¼Œçœ‹ä¸€ä¸‹ createMap çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createMap</span><span class="params">(Thread t, T firstValue)</span> </span>&#123;</span><br><span class="line">    t.threadLocals = <span class="keyword">new</span> ThreadLocalMap(<span class="keyword">this</span>, firstValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="threadlocal-æºç å°ç»“"><a class="markdownIt-Anchor" href="#threadlocal-æºç å°ç»“"></a> ThreadLocal æºç å°ç»“</h5>
<p>è‡³æ­¤ï¼Œå¯èƒ½å¤§éƒ¨åˆ†æœ‹å‹å·²ç»æ˜ç™½äº† ThreadLocal æ˜¯å¦‚ä½•ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºå˜é‡çš„å‰¯æœ¬çš„ï¼š</p>
<ol>
<li>åœ¨æ¯ä¸ªçº¿ç¨‹ Thread å†…éƒ¨æœ‰ä¸€ä¸ª ThreadLocal.ThreadLocalMap ç±»å‹çš„æˆå‘˜å˜é‡ threadLocalsï¼Œè¿™ä¸ª threadLocals å°±æ˜¯ç”¨æ¥å­˜å‚¨å®é™…çš„å˜é‡å‰¯æœ¬çš„ï¼Œé”®å€¼ä¸ºå½“å‰ ThreadLocal å˜é‡ï¼Œvalue ä¸ºå˜é‡å‰¯æœ¬ï¼ˆå³ T ç±»å‹çš„å˜é‡ï¼‰ã€‚</li>
<li>åœ¨ Thread é‡Œé¢ï¼ŒthreadLocals ä¸ºç©ºï¼Œå½“é€šè¿‡ ThreadLocal å˜é‡è°ƒç”¨ get()æ–¹æ³•æˆ–è€… set()æ–¹æ³•ï¼Œå°±ä¼šå¯¹ Thread ç±»ä¸­çš„ threadLocals è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¸”ä»¥å½“å‰ ThreadLocal å˜é‡ä¸ºé”®å€¼ï¼Œä»¥ ThreadLocal è¦ä¿å­˜çš„å‰¯æœ¬å˜é‡ä¸º valueï¼Œå­˜åˆ° threadLocalsã€‚</li>
<li>åœ¨å½“å‰çº¿ç¨‹é‡Œé¢ï¼Œå¦‚æœè¦ä½¿ç”¨å‰¯æœ¬å˜é‡ï¼Œå°±å¯ä»¥é€šè¿‡ get æ–¹æ³•åœ¨ threadLocals é‡Œé¢æŸ¥æ‰¾ã€‚</li>
</ol>
<h4 id="ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹"></a> ç¤ºä¾‹</h4>
<p>ThreadLocal æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯ä¸ºç”¨äºè§£å†³æ•°æ®åº“è¿æ¥ã€Session ç®¡ç†ç­‰é—®é¢˜ã€‚</p>
<p>ç¤ºä¾‹ - æ•°æ®åº“è¿æ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; connectionHolder</span><br><span class="line">= <span class="keyword">new</span> ThreadLocal&lt;Connection&gt;() &#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Connection <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> DriverManager.getConnection(DB_URL);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> connectionHolder.get();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ - Session ç®¡ç†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal threadSession = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Session <span class="title">getSession</span><span class="params">()</span> <span class="keyword">throws</span> InfrastructureException </span>&#123;</span><br><span class="line">    Session s = (Session) threadSession.get();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (s == <span class="keyword">null</span>) &#123;</span><br><span class="line">            s = getSessionFactory().openSession();</span><br><span class="line">            threadSession.set(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (HibernateException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> InfrastructureException(ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç®¡é“è¾“å…¥è¾“å‡ºæµ"><a class="markdownIt-Anchor" href="#ç®¡é“è¾“å…¥è¾“å‡ºæµ"></a> ç®¡é“è¾“å…¥/è¾“å‡ºæµ</h3>
<p>ç®¡é“è¾“å…¥/è¾“å‡ºæµå’Œæ™®é€šçš„æ–‡ä»¶è¾“å…¥/è¾“å‡ºæµæˆ–è€…ç½‘ç»œè¾“å…¥/è¾“å‡ºæµä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¸»è¦ç”¨äºçº¿ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè€Œä¼ è¾“çš„åª’ä»‹ä¸ºå†…å­˜ã€‚<br>
ç®¡é“è¾“å…¥/è¾“å‡ºæµä¸»è¦åŒ…æ‹¬äº†å¦‚ä¸‹ 4 ç§å…·ä½“å®ç°ï¼šPipedOutputStreamã€PipedInputStreamã€PipedReader å’Œ PipedWriterï¼Œå‰ä¸¤ç§é¢å‘å­—èŠ‚ï¼Œè€Œåä¸¤ç§é¢å‘å­—ç¬¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Piped</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PipedWriter out = <span class="keyword">new</span> PipedWriter();</span><br><span class="line">        PipedReader in = <span class="keyword">new</span> PipedReader();</span><br><span class="line">        <span class="comment">// å°†è¾“å‡ºæµå’Œè¾“å…¥æµè¿›è¡Œè¿æ¥ï¼Œå¦åˆ™åœ¨ä½¿ç”¨æ—¶ä¼šæŠ›å‡ºIOException</span></span><br><span class="line">        out.connect(in);</span><br><span class="line">        Thread printThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Print(in), <span class="string">"PrintThread"</span>);</span><br><span class="line">        printThread.start();</span><br><span class="line">        <span class="keyword">int</span> receive = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((receive = System.in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                out.write(receive);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            out.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> PipedReader in;</span><br><span class="line"></span><br><span class="line">        Print(PipedReader in) &#123;</span><br><span class="line">            <span class="keyword">this</span>.in = in;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> receive = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> ((receive = in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    System.out.print((<span class="keyword">char</span>) receive);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="faq"><a class="markdownIt-Anchor" href="#faq"></a> FAQ</h2>
<h3 id="start-å’Œ-run-æœ‰ä»€ä¹ˆåŒºåˆ«å¯ä»¥ç›´æ¥è°ƒç”¨-thread-ç±»çš„-run-æ–¹æ³•ä¹ˆ"><a class="markdownIt-Anchor" href="#start-å’Œ-run-æœ‰ä»€ä¹ˆåŒºåˆ«å¯ä»¥ç›´æ¥è°ƒç”¨-thread-ç±»çš„-run-æ–¹æ³•ä¹ˆ"></a> start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ</h3>
<p>run() æ–¹æ³•æ˜¯çº¿ç¨‹çš„æ‰§è¡Œä½“ã€‚</p>
<p>start() æ–¹æ³•ä¼šå¯åŠ¨çº¿ç¨‹ï¼Œç„¶å JVM ä¼šè®©è¿™ä¸ªçº¿ç¨‹å»æ‰§è¡Œ run() æ–¹æ³•ã€‚</p>
<p>å¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ</p>
<ul>
<li>å¯ä»¥ã€‚ä½†æ˜¯å¦‚æœç›´æ¥è°ƒç”¨ Thread çš„ run()æ–¹æ³•ï¼Œå®ƒçš„è¡Œä¸ºå°±ä¼šå’Œæ™®é€šçš„æ–¹æ³•ä¸€æ ·ã€‚</li>
<li>ä¸ºäº†åœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œå¿…é¡»ä½¿ç”¨ Thread.start()æ–¹æ³•ã€‚</li>
</ul>
<h3 id="sleep-yield-join-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ä¸ºä»€ä¹ˆ-sleepå’Œ-yieldæ–¹æ³•æ˜¯é™æ€çš„"><a class="markdownIt-Anchor" href="#sleep-yield-join-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ä¸ºä»€ä¹ˆ-sleepå’Œ-yieldæ–¹æ³•æ˜¯é™æ€çš„"></a> sleep()ã€yield()ã€join() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆ sleep()å’Œ yield()æ–¹æ³•æ˜¯é™æ€çš„ï¼Ÿ</h3>
<ul>
<li>yield()
<ul>
<li>yield() æ–¹æ³•å¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œä½†å®ƒä¸ä¼šé˜»å¡è¯¥çº¿ç¨‹ï¼Œå®ƒåªæ˜¯å°†è¯¥çº¿ç¨‹ä» Running çŠ¶æ€è½¬å…¥ Runnable çŠ¶æ€ã€‚</li>
<li>å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº† yield() æ–¹æ³•æš‚åœä¹‹åï¼Œåªæœ‰ä¼˜å…ˆçº§ä¸å½“å‰çº¿ç¨‹ç›¸åŒï¼Œæˆ–è€…ä¼˜å…ˆçº§æ¯”å½“å‰çº¿ç¨‹æ›´é«˜çš„å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ‰ä¼šè·å¾—æ‰§è¡Œçš„æœºä¼šã€‚</li>
</ul>
</li>
<li>sleep()
<ul>
<li>sleep() æ–¹æ³•éœ€è¦æŒ‡å®šç­‰å¾…çš„æ—¶é—´ï¼Œå®ƒå¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹åœ¨æŒ‡å®šçš„æ—¶é—´å†…æš‚åœæ‰§è¡Œï¼Œè¿›å…¥ Blocked çŠ¶æ€ã€‚</li>
<li>è¯¥æ–¹æ³•æ—¢å¯ä»¥è®©å…¶ä»–åŒä¼˜å…ˆçº§æˆ–è€…é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œçš„æœºä¼šï¼Œä¹Ÿå¯ä»¥è®©ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œæœºä¼šã€‚</li>
<li>ä½†æ˜¯ï¼Œ sleep() æ–¹æ³•ä¸ä¼šé‡Šæ”¾â€œé”æ ‡å¿—â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰ synchronized åŒæ­¥å—ï¼Œå…¶ä»–çº¿ç¨‹ä»ç„¶ä¸èƒ½è®¿é—®å…±äº«æ•°æ®ã€‚</li>
</ul>
</li>
<li>join()
<ul>
<li>join() æ–¹æ³•ä¼šä½¿å½“å‰çº¿ç¨‹è½¬å…¥ Blocked çŠ¶æ€ï¼Œç­‰å¾…è°ƒç”¨ join() æ–¹æ³•çš„çº¿ç¨‹ç»“æŸåæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>å‚è€ƒé˜…è¯»ï¼š<a href="http://www.importnew.com/14958.html" target="_blank" rel="noopener">Java çº¿ç¨‹ä¸­ yield ä¸ join æ–¹æ³•çš„åŒºåˆ«</a><br>
å‚è€ƒé˜…è¯»ï¼š<a href="https://blog.csdn.net/xiangwanpeng/article/details/54972952" target="_blank" rel="noopener">sleep()ï¼Œwait()ï¼Œyield()å’Œ join()æ–¹æ³•çš„åŒºåˆ«</a></p>
</blockquote>
<h3 id="ä¸ºä»€ä¹ˆ-sleep-å’Œ-yield-æ–¹æ³•æ˜¯é™æ€çš„"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆ-sleep-å’Œ-yield-æ–¹æ³•æ˜¯é™æ€çš„"></a> ä¸ºä»€ä¹ˆ sleep() å’Œ yield() æ–¹æ³•æ˜¯é™æ€çš„</h3>
<ul>
<li>Thread ç±»çš„ sleep() å’Œ yield() æ–¹æ³•å°†å¤„ç† Running çŠ¶æ€çš„çº¿ç¨‹ã€‚æ‰€ä»¥åœ¨å…¶ä»–å¤„äºé Running çŠ¶æ€çš„çº¿ç¨‹ä¸Šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™äº›æ–¹æ³•æ˜¯é™æ€çš„ã€‚å®ƒä»¬å¯ä»¥åœ¨å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¸­å·¥ä½œï¼Œå¹¶é¿å…ç¨‹åºå‘˜é”™è¯¯çš„è®¤ä¸ºå¯ä»¥åœ¨å…¶ä»–éè¿è¡Œçº¿ç¨‹è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</li>
</ul>
<h3 id="java-çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶é«˜ä¼˜å…ˆçº§çš„-java-çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—"><a class="markdownIt-Anchor" href="#java-çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶é«˜ä¼˜å…ˆçº§çš„-java-çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—"></a> Java çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶ï¼Ÿé«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—ï¼Ÿ</h3>
<ul>
<li>Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶
<ul>
<li>Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ [1,10]ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå…·æœ‰ä¼˜å…ˆæƒã€‚å¯ä»¥é€šè¿‡ <code>thread.setPriority(Thread.MAX_PRIORITY)</code> çš„æ–¹å¼è®¾ç½®ï¼Œé»˜è®¤ä¼˜å…ˆçº§ä¸º 5ã€‚</li>
</ul>
</li>
<li>é«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—
<ul>
<li>å³ä½¿è®¾ç½®äº†çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œä¹Ÿ<strong>æ— æ³•ä¿è¯é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œ</strong>ã€‚</li>
<li>åŸå› ï¼šè¿™æ˜¯å› ä¸ºçº¿ç¨‹ä¼˜å…ˆçº§ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œç„¶è€Œï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿæ”¯æŒçš„çº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸ç›¸åŒï¼Œä¸èƒ½å¾ˆå¥½çš„å’Œ Java ä¸­çº¿ç¨‹ä¼˜å…ˆçº§ä¸€ä¸€å¯¹åº”ã€‚</li>
<li>ç»“è®ºï¼šJava çº¿ç¨‹ä¼˜å…ˆçº§æ§åˆ¶å¹¶ä¸å¯é ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹"></a> ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Ÿå¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</h3>
<ul>
<li>ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹
<ul>
<li>å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰æ˜¯åœ¨åå°æ‰§è¡Œå¹¶ä¸”ä¸ä¼šé˜»æ­¢ JVM ç»ˆæ­¢çš„çº¿ç¨‹ã€‚</li>
<li>ä¸å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ç›¸åçš„ï¼Œå«ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰ï¼Œä¹Ÿå°±æ˜¯éå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
</ul>
</li>
<li>ä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹
<ul>
<li>å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾å›æ”¶å™¨ã€‚</li>
</ul>
</li>
<li>å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹
<ul>
<li>ä½¿ç”¨ thread.setDaemon(true) å¯ä»¥è®¾ç½® thread çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>æ³¨æ„ç‚¹ï¼š
<ul>
<li>æ­£åœ¨è¿è¡Œçš„ç”¨æˆ·çº¿ç¨‹æ— æ³•è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥ thread.setDaemon(true) å¿…é¡»åœ¨ thread.start() ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™ä¼šæŠ›å‡º llegalThreadStateException å¼‚å¸¸ï¼›</li>
<li>ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¾ç„¶æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>ä¸è¦è®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åˆ†é…ç»™ Daemon æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>å‚è€ƒé˜…è¯»ï¼š<a href="https://blog.csdn.net/shimiso/article/details/8964414" target="_blank" rel="noopener">Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“</a></p>
</blockquote>
<h3 id="ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-notifyå’Œ-notifyallè¢«å®šä¹‰åœ¨-object-ç±»é‡Œ"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-notifyå’Œ-notifyallè¢«å®šä¹‰åœ¨-object-ç±»é‡Œ"></a> ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait(), notify()å’Œ notifyAll()è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ</h3>
<p>Java çš„æ¯ä¸ªå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªé”(monitorï¼Œä¹Ÿå¯ä»¥æˆä¸ºç›‘è§†å™¨) å¹¶ä¸” wait()ï¼Œnotify()ç­‰æ–¹æ³•ç”¨äºç­‰å¾…å¯¹è±¡çš„é”æˆ–è€…é€šçŸ¥å…¶ä»–çº¿ç¨‹å¯¹è±¡çš„ç›‘è§†å™¨å¯ç”¨ã€‚åœ¨ Java çš„çº¿ç¨‹ä¸­å¹¶æ²¡æœ‰å¯ä¾›ä»»ä½•å¯¹è±¡ä½¿ç”¨çš„é”å’ŒåŒæ­¥å™¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™äº›æ–¹æ³•æ˜¯ Object ç±»çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ · Java çš„æ¯ä¸€ä¸ªç±»éƒ½æœ‰ç”¨äºçº¿ç¨‹é—´é€šä¿¡çš„åŸºæœ¬æ–¹æ³•</p>
<h3 id="ä¸ºä»€ä¹ˆ-wait-notifyå’Œ-notifyallå¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆ-wait-notifyå’Œ-notifyallå¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨"></a> ä¸ºä»€ä¹ˆ wait(), notify()å’Œ notifyAll()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</h3>
<p>å½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ wait()æ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªçº¿ç¨‹å¿…é¡»æ‹¥æœ‰è¯¥å¯¹è±¡çš„é”ï¼Œæ¥ç€å®ƒå°±ä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸Šçš„ notify()æ–¹æ³•ã€‚åŒæ ·çš„ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ notify()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œä»¥ä¾¿å…¶ä»–åœ¨ç­‰å¾…çš„çº¿ç¨‹å°±å¯ä»¥å¾—åˆ°è¿™ä¸ªå¯¹è±¡é”ã€‚ç”±äºæ‰€æœ‰çš„è¿™äº›æ–¹æ³•éƒ½éœ€è¦çº¿ç¨‹æŒæœ‰å¯¹è±¡çš„é”ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡åŒæ­¥æ¥å®ç°ï¼Œæ‰€ä»¥ä»–ä»¬åªèƒ½åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ã€‚</p>
<blockquote>
<p>å‚è€ƒé˜…è¯»ï¼š<a href="http://www.cnblogs.com/dolphin0520/p/3920373.html" target="_blank" rel="noopener">Java å¹¶å‘ç¼–ç¨‹ï¼švolatile å…³é”®å­—è§£æ</a></p>
</blockquote>
<h2 id="èµ„æ–™"><a class="markdownIt-Anchor" href="#èµ„æ–™"></a> èµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/10922250.html" target="_blank" rel="noopener">Java å¹¶å‘ç¼–ç¨‹å®æˆ˜</a></li>
<li><a href="https://item.jd.com/11740734.html" target="_blank" rel="noopener">Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯</a></li>
<li><a href="https://stackoverflow.com/questions/27406200/visualvm-thread-states" target="_blank" rel="noopener">https://stackoverflow.com/questions/27406200/visualvm-thread-states</a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/index.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/api/index.html</a></li>
<li><a href="https://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example" target="_blank" rel="noopener">https://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example</a></li>
<li><a href="http://www.importnew.com/14958.html" target="_blank" rel="noopener">http://www.importnew.com/14958.html</a></li>
<li><a href="https://blog.csdn.net/xiangwanpeng/article/details/54972952" target="_blank" rel="noopener">https://blog.csdn.net/xiangwanpeng/article/details/54972952</a></li>
<li><a href="https://blog.csdn.net/shimiso/article/details/8964414" target="_blank" rel="noopener">https://blog.csdn.net/shimiso/article/details/8964414</a></li>
</ul>

      
    </div>

    
      


    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Zhang Peng</li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    
    <a href="https://dunwu.github.io/2018/05/22/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€/" title="çº¿ç¨‹åŸºç¡€">https://dunwu.github.io/2018/05/22/programming/java/javacore/concurrent/çº¿ç¨‹åŸºç¡€/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/programming/" rel="tag"># programming</a>
          
            <a href="/blog/tags/javacore/" rel="tag"># javacore</a>
          
            <a href="/blog/tags/java/" rel="tag"># java</a>
          
            <a href="/blog/tags/concurrent/" rel="tag"># concurrent</a>
          
            <a href="/blog/tags/thread/" rel="tag"># thread</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2018/05/21/programming/java/javacore/concurrent/å¹¶å‘ç®€ä»‹/" rel="next" title="å¹¶å‘ç®€ä»‹">
                <i class="fa fa-chevron-left"></i> å¹¶å‘ç®€ä»‹
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2018/05/24/programming/java/javacore/concurrent/åŸå­å˜é‡ç±»/" rel="prev" title="åŸå­å˜é‡ç±»">
                åŸå­å˜é‡ç±» <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/blog/images/avatar.gif" alt="Zhang Peng">
            
              <p class="site-author-name" itemprop="name">Zhang Peng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/blog/archives/">
                
                    <span class="site-state-item-count">357</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/blog/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">27</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/blog/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">103</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/blog/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/dunwu" title="GitHub &rarr; https://github.com/dunwu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:forbreak@163.com" title="E-Mail &rarr; mailto:forbreak@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/blog/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#çº¿ç¨‹åŸºç¡€"><span class="nav-text"> çº¿ç¨‹åŸºç¡€</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#çº¿ç¨‹ç®€ä»‹"><span class="nav-text"> çº¿ç¨‹ç®€ä»‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹"><span class="nav-text"> ä»€ä¹ˆæ˜¯çº¿ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ"><span class="nav-text"> çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹"><span class="nav-text"> å¯åŠ¨å’Œç»ˆæ­¢çº¿ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ„é€ çº¿ç¨‹"><span class="nav-text"> æ„é€ çº¿ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç»§æ‰¿-thread-ç±»"><span class="nav-text"> ç»§æ‰¿ Thread ç±»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å®ç°-runnable-æ¥å£"><span class="nav-text"> å®ç° Runnable æ¥å£</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å®ç°-callable-æ¥å£"><span class="nav-text"> å®ç° Callable æ¥å£</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ–¹å¼å¯¹æ¯”"><span class="nav-text"> ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ–¹å¼å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸­æ–­çº¿ç¨‹"><span class="nav-text"> ä¸­æ–­çº¿ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç»ˆæ­¢çº¿ç¨‹"><span class="nav-text"> ç»ˆæ­¢çº¿ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#thread-ä¸­çš„é‡è¦æ–¹æ³•"><span class="nav-text"> Thread ä¸­çš„é‡è¦æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è®¾ç½®è·å–çº¿ç¨‹åç§°"><span class="nav-text"> è®¾ç½®/è·å–çº¿ç¨‹åç§°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨"><span class="nav-text"> åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å®ˆæŠ¤çº¿ç¨‹"><span class="nav-text"> å®ˆæŠ¤çº¿ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è®¾ç½®è·å–çº¿ç¨‹ä¼˜å…ˆçº§"><span class="nav-text"> è®¾ç½®/è·å–çº¿ç¨‹ä¼˜å…ˆçº§</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#çº¿ç¨‹é—´é€šä¿¡"><span class="nav-text"> çº¿ç¨‹é—´é€šä¿¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#waitnotifynotifyall"><span class="nav-text"> wait/notify/notifyAll</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#çº¿ç¨‹çš„ç¤¼è®©"><span class="nav-text"> çº¿ç¨‹çš„ç¤¼è®©</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#çº¿ç¨‹çš„å¼ºåˆ¶æ‰§è¡Œ"><span class="nav-text"> çº¿ç¨‹çš„å¼ºåˆ¶æ‰§è¡Œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#çº¿ç¨‹çš„ä¼‘çœ "><span class="nav-text"> çº¿ç¨‹çš„ä¼‘çœ </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#threadlocal"><span class="nav-text"> ThreadLocal</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æºç "><span class="nav-text"> æºç </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç¤ºä¾‹"><span class="nav-text"> ç¤ºä¾‹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®¡é“è¾“å…¥è¾“å‡ºæµ"><span class="nav-text"> ç®¡é“è¾“å…¥/è¾“å‡ºæµ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#faq"><span class="nav-text"> FAQ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#start-å’Œ-run-æœ‰ä»€ä¹ˆåŒºåˆ«å¯ä»¥ç›´æ¥è°ƒç”¨-thread-ç±»çš„-run-æ–¹æ³•ä¹ˆ"><span class="nav-text"> start() å’Œ run() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ Thread ç±»çš„ run() æ–¹æ³•ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sleep-yield-join-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ä¸ºä»€ä¹ˆ-sleepå’Œ-yieldæ–¹æ³•æ˜¯é™æ€çš„"><span class="nav-text"> sleep()ã€yield()ã€join() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆ sleep()å’Œ yield()æ–¹æ³•æ˜¯é™æ€çš„ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆ-sleep-å’Œ-yield-æ–¹æ³•æ˜¯é™æ€çš„"><span class="nav-text"> ä¸ºä»€ä¹ˆ sleep() å’Œ yield() æ–¹æ³•æ˜¯é™æ€çš„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#java-çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶é«˜ä¼˜å…ˆçº§çš„-java-çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—"><span class="nav-text"> Java çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶ï¼Ÿé«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹"><span class="nav-text"> ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Ÿå¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³•-wait-notifyå’Œ-notifyallè¢«å®šä¹‰åœ¨-object-ç±»é‡Œ"><span class="nav-text"> ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• wait(), notify()å’Œ notifyAll()è¢«å®šä¹‰åœ¨ Object ç±»é‡Œï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸ºä»€ä¹ˆ-wait-notifyå’Œ-notifyallå¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨"><span class="nav-text"> ä¸ºä»€ä¹ˆ wait(), notify()å’Œ notifyAll()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#èµ„æ–™"><span class="nav-text"> èµ„æ–™</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 â€“ <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-paper-plane"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Peng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="ç«™ç‚¹æ€»å­—æ•°">2.1m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">31:30</span>
  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
      
    
  
  <script color="107,97,95" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1.0.0/canvas-nest.min.js"></script>











  



  
  <script src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-reading-progress@1/reading_progress.min.js"></script>


  


  <script src="/blog/js/src/utils.js?v=7.0.1"></script>

  <script src="/blog/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/blog/js/src/schemes/muse.js?v=7.0.1"></script>



  
  <script src="/blog/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/blog/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/blog/js/src/bootstrap.js?v=7.0.1"></script>


  
  


  


  




  

  

  

  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.scrollToMark('auto', "#æ›´å¤š");
  
  </script>


  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      
        background-color: #eee;
        background-image: linear-gradient(#fcfcfc, #eee);
        border: 1px solid #d5d5d5;
        border-radius: 3px;
      
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      
        right: 4px;
        top: 8px;
      
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1;
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function(i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap');
      $(e).after($wrap);
      $wrap.append($('<button>').addClass('copy-btn').append('å¤åˆ¶').on('click', function(e) {
        var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
          return $(e).text();
        }).toArray().join('\n');
        var ta = document.createElement('textarea');
        var yPosition = window.pageYOffset || document.documentElement.scrollTop;
        ta.style.top = yPosition + 'px'; // Prevent page scroll
        ta.style.position = 'absolute';
        ta.style.opacity = '0';
        ta.readOnly = true;
        ta.value = code;
        document.body.appendChild(ta);
        ta.select();
        ta.setSelectionRange(0, code.length);
        ta.readOnly = false;
        var result = document.execCommand('copy');
        
          if (result) $(this).text('å¤åˆ¶æˆåŠŸ');
          else $(this).text('å¤åˆ¶å¤±è´¥');
        
        ta.blur(); // For iOS
        $(this).blur();
      })).on('mouseleave', function(e) {
        var $b = $(this).find('.copy-btn');
        setTimeout(function() {
          $b.text('å¤åˆ¶');
        }, 300);
      }).append(e);
    })
  </script>


</body>
</html>
