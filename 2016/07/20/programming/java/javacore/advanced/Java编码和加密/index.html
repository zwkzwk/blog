<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css">























<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/blog/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Java ç¼–ç å’ŒåŠ å¯†  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    æœ¯è¯­ Base64 ç¼–ç   ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   éå¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ¶ˆæ¯æ‘˜è¦  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ•°å­—ç­¾å  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å‚è€ƒèµ„æ–™    æœ¯è¯­  æ˜æ–‡(Plaintext)ï¼šæŒ‡å¾…åŠ å¯†ä¿¡æ¯ã€‚æ˜æ–‡å¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚ å¯†æ–‡(Ciphertex">
<meta name="keywords" content="programming,java,javacore,encode,encrypt">
<meta property="og:type" content="article">
<meta property="og:title" content="Java ç¼–ç å’ŒåŠ å¯†">
<meta property="og:url" content="https://dunwu.github.io/2016/07/20/programming/java/javacore/advanced/Javaç¼–ç å’ŒåŠ å¯†/index.html">
<meta property="og:site_name" content="é™é»˜è™šç©ºçš„åšå®¢">
<meta property="og:description" content="Java ç¼–ç å’ŒåŠ å¯†  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    æœ¯è¯­ Base64 ç¼–ç   ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   éå¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ¶ˆæ¯æ‘˜è¦  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ•°å­—ç­¾å  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å‚è€ƒèµ„æ–™    æœ¯è¯­  æ˜æ–‡(Plaintext)ï¼šæŒ‡å¾…åŠ å¯†ä¿¡æ¯ã€‚æ˜æ–‡å¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚ å¯†æ–‡(Ciphertex">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/symmetric-encryption.png">
<meta property="og:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/symmetric-encryption-progress.png">
<meta property="og:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/password-based-encryption-progress.png">
<meta property="og:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/asymmetric-encryption.png">
<meta property="og:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/java-message-digest-process.jpg">
<meta property="og:updated_time" content="2019-03-19T13:31:31.348Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java ç¼–ç å’ŒåŠ å¯†">
<meta name="twitter:description" content="Java ç¼–ç å’ŒåŠ å¯†  ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œblogã€    æœ¯è¯­ Base64 ç¼–ç   ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   éå¯¹ç§°åŠ å¯†  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ¶ˆæ¯æ‘˜è¦  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   æ•°å­—ç­¾å  ç®—æ³•ç®€è¿° ç®—æ³•å®ç°   å‚è€ƒèµ„æ–™    æœ¯è¯­  æ˜æ–‡(Plaintext)ï¼šæŒ‡å¾…åŠ å¯†ä¿¡æ¯ã€‚æ˜æ–‡å¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚ å¯†æ–‡(Ciphertex">
<meta name="twitter:image" content="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/symmetric-encryption.png">



  <link rel="alternate" href="/blog/atom.xml" title="é™é»˜è™šç©ºçš„åšå®¢" type="application/atom+xml">




  <link rel="canonical" href="https://dunwu.github.io/2016/07/20/programming/java/javacore/advanced/Javaç¼–ç å’ŒåŠ å¯†/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Java ç¼–ç å’ŒåŠ å¯† | é™é»˜è™šç©ºçš„åšå®¢</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">é™é»˜è™šç©ºçš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/blog/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/blog/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

  <a href="https://github.com/dunwu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/2016/07/20/programming/java/javacore/advanced/Javaç¼–ç å’ŒåŠ å¯†/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™é»˜è™šç©ºçš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Java ç¼–ç å’ŒåŠ å¯†<a href="https://github.com/dunwu/blog/blob/master/source/_posts/programming/java/javacore/advanced/Javaç¼–ç å’ŒåŠ å¯†.md" class="post-edit-link" title="ç¼–è¾‘" rel="noopener" target="_blank"><i class="fa fa-pencil"></i></a>

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-20 14:46:00" itemprop="dateCreated datePublished" datetime="2016-07-20T14:46:00+08:00">2016-07-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-03-19 21:31:31" itemprop="dateModified" datetime="2019-03-19T21:31:31+08:00">2019-03-19</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/" itemprop="url" rel="index"><span itemprop="name">programming</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/javacore/" itemprop="url" rel="index"><span itemprop="name">javacore</span></a></span>

                
                
                  ï¼Œ
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/programming/java/javacore/advanced/" itemprop="url" rel="index"><span itemprop="name">advanced</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
                
                <span title="æœ¬æ–‡å­—æ•°">23k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">21 åˆ†é’Ÿ</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="java-ç¼–ç å’ŒåŠ å¯†"><a class="markdownIt-Anchor" href="#java-ç¼–ç å’ŒåŠ å¯†"></a> Java ç¼–ç å’ŒåŠ å¯†</h1>
<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E6%9C%AF%E8%AF%AD">æœ¯è¯­</a></li>
<li><a href="#base64-%E7%BC%96%E7%A0%81">Base64 ç¼–ç </a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E7%AE%80%E8%BF%B0">ç®—æ³•ç®€è¿°</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0">ç®—æ³•å®ç°</a></li>
</ul>
</li>
<li><a href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">å¯¹ç§°åŠ å¯†</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E7%AE%80%E8%BF%B0-1">ç®—æ³•ç®€è¿°</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0-1">ç®—æ³•å®ç°</a></li>
</ul>
</li>
<li><a href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">éå¯¹ç§°åŠ å¯†</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E7%AE%80%E8%BF%B0-2">ç®—æ³•ç®€è¿°</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0-2">ç®—æ³•å®ç°</a></li>
</ul>
</li>
<li><a href="#%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81">æ¶ˆæ¯æ‘˜è¦</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E7%AE%80%E8%BF%B0-3">ç®—æ³•ç®€è¿°</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0-3">ç®—æ³•å®ç°</a></li>
</ul>
</li>
<li><a href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D">æ•°å­—ç­¾å</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95%E7%AE%80%E8%BF%B0-4">ç®—æ³•ç®€è¿°</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0-4">ç®—æ³•å®ç°</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="æœ¯è¯­"><a class="markdownIt-Anchor" href="#æœ¯è¯­"></a> æœ¯è¯­</h2>
<ul>
<li><strong>æ˜æ–‡(Plaintext)</strong>ï¼šæŒ‡å¾…åŠ å¯†ä¿¡æ¯ã€‚æ˜æ–‡å¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚</li>
<li><strong>å¯†æ–‡(Ciphertext)</strong>ï¼šæŒ‡ç»è¿‡åŠ å¯†åçš„æ˜æ–‡ã€‚å¯†æ–‡é€šå¸¸ä»¥æ–‡æœ¬ã€äºŒè¿›åˆ¶ç­‰å½¢å¼å­˜åœ¨ã€‚</li>
<li><strong>åŠ å¯†(Encryption)</strong>ï¼šæŒ‡å°†æ˜æ–‡è½¬æ¢ä¸ºå¯†æ–‡çš„è¿‡ç¨‹ã€‚</li>
<li><strong>è§£å¯†(Decryption)</strong>ï¼šæŒ‡å°†å¯†æ–‡è½¬æ¢ä¸ºæ˜æ–‡çš„è¿‡ç¨‹ã€‚</li>
<li><strong>åŠ å¯†å¯†é’¥(Encryption Key)</strong>ï¼šæŒ‡é€šè¿‡åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†æ“ä½œç”¨çš„å¯†é’¥ã€‚</li>
<li><strong>è§£å¯†å¯†é’¥(Decryption Key)</strong>ï¼šæŒ‡é€šè¿‡è§£å¯†ç®—æ³•è¿›è¡Œè§£å¯†æ“ä½œç”¨çš„å¯†é’¥ã€‚</li>
<li><strong>ä¿¡é“(Channel)</strong>ï¼šé€šä¿¡çš„é€šé“ï¼Œæ˜¯ä¿¡å·ä¼ è¾“çš„åª’ä»‹ã€‚</li>
</ul>
<h2 id="base64-ç¼–ç "><a class="markdownIt-Anchor" href="#base64-ç¼–ç "></a> Base64 ç¼–ç </h2>
<h3 id="ç®—æ³•ç®€è¿°"><a class="markdownIt-Anchor" href="#ç®—æ³•ç®€è¿°"></a> ç®—æ³•ç®€è¿°</h3>
<h4 id="å®šä¹‰"><a class="markdownIt-Anchor" href="#å®šä¹‰"></a> å®šä¹‰</h4>
<p>Base64 å†…å®¹ä¼ é€ç¼–ç æ˜¯ä¸€ç§ä»¥ä»»æ„ 8 ä½å­—èŠ‚åºåˆ—ç»„åˆçš„æè¿°å½¢å¼ï¼Œè¿™ç§å½¢å¼ä¸æ˜“è¢«äººç›´æ¥è¯†åˆ«ã€‚</p>
<p>Base64 æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„ç¼–ç è§„èŒƒï¼Œå…¶ä½œç”¨æ˜¯å°†äºŒè¿›åˆ¶åºåˆ—è½¬æ¢ä¸ºäººç±»å¯è¯»çš„ ASCII å­—ç¬¦åºåˆ—ï¼Œå¸¸ç”¨åœ¨éœ€ç”¨é€šè¿‡æ–‡æœ¬åè®®ï¼ˆæ¯”å¦‚ HTTP å’Œ SMTPï¼‰æ¥ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®çš„æƒ…å†µä¸‹ã€‚<strong>Base64 å¹¶ä¸æ˜¯åŠ å¯†è§£å¯†ç®—æ³•</strong>ï¼Œå°½ç®¡æˆ‘ä»¬æœ‰æ—¶ä¹Ÿå¬åˆ°ä½¿ç”¨ Base64 æ¥åŠ å¯†è§£å¯†çš„è¯´æ³•ï¼Œä½†è¿™é‡Œæ‰€è¯´çš„åŠ å¯†ä¸è§£å¯†å®é™…æ˜¯æŒ‡**ç¼–ç ï¼ˆencodeï¼‰<strong>å’Œ</strong>è§£ç ï¼ˆdecodeï¼‰**çš„è¿‡ç¨‹ï¼Œå…¶å˜æ¢æ˜¯éå¸¸ç®€å•çš„ï¼Œä»…ä»…èƒ½å¤Ÿé¿å…ä¿¡æ¯è¢«ç›´æ¥è¯†åˆ«ã€‚</p>
<h4 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h4>
<p>Base64 ç®—æ³•ä¸»è¦æ˜¯å°†ç»™å®šçš„å­—ç¬¦ä»¥å­—ç¬¦ç¼–ç (å¦‚ ASCII ç ï¼ŒUTF-8 ç )å¯¹åº”çš„åè¿›åˆ¶æ•°ä¸ºåŸºå‡†ï¼Œåšç¼–ç æ“ä½œï¼š</p>
<ol>
<li>å°†ç»™å®šçš„å­—ç¬¦ä¸²ä»¥å­—ç¬¦ä¸ºå•ä½ï¼Œè½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ç¼–ç ã€‚</li>
<li>å°†è·å¾—å­—ç¬¦ç¼–ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶</li>
<li>å¯¹äºŒè¿›åˆ¶ç åšåˆ†ç»„è½¬æ¢ï¼Œæ¯ 3 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œè½¬æ¢ä¸ºæ¯ 4 ä¸ª 6 ä½äºŒè¿›åˆ¶ä½ä¸€ç»„ï¼ˆä¸è¶³ 6 ä½æ—¶ä½ä½è¡¥ 0ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªåˆ†ç»„å˜åŒ–çš„è¿‡ç¨‹ï¼Œ3 ä¸ª 8 ä½äºŒè¿›åˆ¶ç å’Œ 4 ä¸ª 6 ä½äºŒè¿›åˆ¶ç çš„é•¿åº¦éƒ½æ˜¯ 24 ä½ï¼ˆ3<em>8 = 4</em>6 = 24ï¼‰ã€‚</li>
<li>å¯¹è·å¾—çš„ 4-6 äºŒè¿›åˆ¶ç è¡¥ä½ï¼Œå‘ 6 ä½äºŒè¿›åˆ¶ç æ·»åŠ  2 ä½é«˜ä½ 0ï¼Œç»„æˆ 4 ä¸ª 8 ä½äºŒè¿›åˆ¶ç ã€‚</li>
<li>å¯¹è·å¾—çš„ 4-8 äºŒè¿›åˆ¶ç è½¬æ¢ä¸ºåè¿›åˆ¶ç ã€‚</li>
<li>å°†è·å¾—çš„åè¿›åˆ¶ç è½¬æ¢ä¸º Base64 å­—ç¬¦è¡¨ä¸­å¯¹åº”çš„å­—ç¬¦ã€‚</li>
</ol>
<p><strong><em>Base64 ç¼–ç è¡¨</em></strong></p>
<table>
<thead>
<tr>
<th><strong>ç´¢å¼•</strong></th>
<th><strong>å¯¹åº”å­—ç¬¦</strong></th>
<th><strong>ç´¢å¼•</strong></th>
<th><strong>å¯¹åº”å­—ç¬¦</strong></th>
<th><strong>ç´¢å¼•</strong></th>
<th><strong>å¯¹åº”å­—ç¬¦</strong></th>
<th><strong>ç´¢å¼•</strong></th>
<th><strong>å¯¹åº”å­—ç¬¦</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>A</td>
<td>17</td>
<td>R</td>
<td>34</td>
<td>i</td>
<td>51</td>
<td>z</td>
</tr>
<tr>
<td>1</td>
<td>B</td>
<td>18</td>
<td>S</td>
<td>35</td>
<td>j</td>
<td>52</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>C</td>
<td>19</td>
<td>T</td>
<td>36</td>
<td>k</td>
<td>53</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>D</td>
<td>20</td>
<td>U</td>
<td>37</td>
<td>l</td>
<td>54</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>E</td>
<td>21</td>
<td>V</td>
<td>38</td>
<td>m</td>
<td>55</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>F</td>
<td>22</td>
<td>W</td>
<td>39</td>
<td>n</td>
<td>56</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>G</td>
<td>23</td>
<td>X</td>
<td>40</td>
<td>o</td>
<td>57</td>
<td>5</td>
</tr>
<tr>
<td>7</td>
<td>H</td>
<td>24</td>
<td>Y</td>
<td>41</td>
<td>p</td>
<td>58</td>
<td>6</td>
</tr>
<tr>
<td>8</td>
<td>I</td>
<td>25</td>
<td>Z</td>
<td>42</td>
<td>q</td>
<td>59</td>
<td>7</td>
</tr>
<tr>
<td>9</td>
<td>J</td>
<td>26</td>
<td>a</td>
<td>43</td>
<td>r</td>
<td>60</td>
<td>8</td>
</tr>
<tr>
<td>10</td>
<td>K</td>
<td>27</td>
<td>b</td>
<td>44</td>
<td>s</td>
<td>61</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>L</td>
<td>28</td>
<td>c</td>
<td>45</td>
<td>t</td>
<td>62</td>
<td>+</td>
</tr>
<tr>
<td>12</td>
<td>M</td>
<td>29</td>
<td>d</td>
<td>46</td>
<td>u</td>
<td>63</td>
<td>/</td>
</tr>
<tr>
<td>13</td>
<td>N</td>
<td>30</td>
<td>e</td>
<td>47</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>O</td>
<td>31</td>
<td>f</td>
<td>48</td>
<td>w</td>
<td></td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>P</td>
<td>32</td>
<td>g</td>
<td>49</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>Q</td>
<td>33</td>
<td>h</td>
<td>50</td>
<td>y</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="åº”ç”¨"><a class="markdownIt-Anchor" href="#åº”ç”¨"></a> åº”ç”¨</h4>
<p>Base64 ç¼–ç å¯ç”¨äºåœ¨ HTTP ç¯å¢ƒä¸‹ä¼ é€’è¾ƒé•¿çš„æ ‡è¯†ä¿¡æ¯ã€‚åœ¨å…¶ä»–åº”ç”¨ç¨‹åºä¸­ï¼Œä¹Ÿå¸¸å¸¸éœ€è¦æŠŠäºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºé€‚åˆæ”¾åœ¨ URL(åŒ…æ‹¬éšè—è¡¨å•åŸŸ)ä¸­çš„å½¢å¼ã€‚æ­¤æ—¶ï¼Œé‡‡ç”¨ Base64 ç¼–ç å…·æœ‰ä¸å¯è¯»æ€§ï¼Œå³æ‰€ç¼–ç çš„æ•°æ®ä¸ä¼šè¢«äººç”¨è‚‰çœ¼æ‰€ç›´æ¥çœ‹åˆ°ï¼Œç®—æ˜¯èµ·åˆ°ä¸€ä¸ªåŠ å¯†çš„ä½œç”¨ã€‚</p>
<p>ç„¶è€Œï¼Œ<strong>æ ‡å‡†çš„ Base64 å¹¶ä¸é€‚åˆç›´æ¥æ”¾åœ¨ URL é‡Œä¼ è¾“</strong>ï¼Œå› ä¸º URL ç¼–ç å™¨ä¼šæŠŠæ ‡å‡† Base64 ä¸­çš„â€œ/â€å’Œâ€œ+â€å­—ç¬¦å˜ä¸ºå½¢å¦‚â€œ%XXâ€çš„å½¢å¼ï¼Œè€Œè¿™äº›â€œ%â€å·åœ¨å­˜å…¥æ•°æ®åº“æ—¶è¿˜éœ€è¦å†è¿›è¡Œè½¬æ¢ï¼Œå› ä¸º ANSI SQL ä¸­å·²å°†â€œ%â€å·ç”¨ä½œé€šé…ç¬¦ã€‚</p>
<p>ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œå¯é‡‡ç”¨ä¸€ç§ç”¨äº URL çš„æ”¹è¿› Base64 ç¼–ç ï¼Œå®ƒä¸ä»…åœ¨æœ«å°¾å¡«å……â€™='å·ï¼Œå¹¶å°†æ ‡å‡† Base64 ä¸­çš„â€œ+â€å’Œâ€œ/â€åˆ†åˆ«æ”¹æˆäº†â€œ-â€å’Œâ€œ_â€ï¼Œè¿™æ ·å°±å…å»äº†åœ¨ URL ç¼–è§£ç å’Œæ•°æ®åº“å­˜å‚¨æ—¶æ‰€è¦ä½œçš„è½¬æ¢ï¼Œé¿å…äº†ç¼–ç ä¿¡æ¯é•¿åº¦åœ¨æ­¤è¿‡ç¨‹ä¸­çš„å¢åŠ ï¼Œå¹¶ç»Ÿä¸€äº†æ•°æ®åº“ã€è¡¨å•ç­‰å¤„å¯¹è±¡æ ‡è¯†ç¬¦çš„æ ¼å¼ã€‚</p>
<p>å¦æœ‰ä¸€ç§ç”¨äºæ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿› Base64 å˜ç§ï¼Œå®ƒå°†â€œ+â€å’Œâ€œ/â€æ”¹æˆäº†â€œ!â€å’Œâ€œ-â€ï¼Œå› ä¸ºâ€œ+â€,â€œ*â€ä»¥åŠå‰é¢åœ¨ IRCu ä¸­ç”¨åˆ°çš„â€œ[â€å’Œâ€œ]â€åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­éƒ½å¯èƒ½å…·æœ‰ç‰¹æ®Šå«ä¹‰ã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰ä¸€äº›å˜ç§ï¼Œå®ƒä»¬å°†â€œ+/â€æ”¹ä¸ºâ€œ<em>-â€æˆ–â€œ.</em>â€ï¼ˆç”¨ä½œç¼–ç¨‹è¯­è¨€ä¸­çš„æ ‡è¯†ç¬¦åç§°ï¼‰æˆ–â€œ.-â€ï¼ˆç”¨äº XML ä¸­çš„ Nmtokenï¼‰ç”šè‡³â€œ_:â€ï¼ˆç”¨äº XML ä¸­çš„ Nameï¼‰ã€‚</p>
<h3 id="ç®—æ³•å®ç°"><a class="markdownIt-Anchor" href="#ç®—æ³•å®ç°"></a> ç®—æ³•å®ç°</h3>
<p><code>commons-codec</code>å¼€æºåŒ…æä¾›äº†å¯¹äº Base64 çš„å®ç°ï¼Œæ¨èä½¿ç”¨ã€‚</p>
<p>è¯·åœ¨ maven å·¥ç¨‹ä¸­æ·»åŠ ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong><em>èŒƒä¾‹</em></strong></p>
<p>æ³¨ï¼šåœ¨ commons-codec åŒ…ä¸­çš„ Base64 è¿™ä¸ªç±»ä¸­æä¾›äº† Base64 çš„ç¼–ç ã€è§£ç æ–¹å¼ã€‚</p>
<p>å…¶ä¸­ï¼Œ<code>encodeBase64</code>æä¾›çš„æ˜¯æ ‡å‡†çš„ Base64 ç¼–ç æ–¹å¼ï¼›<code>encodeBase64URLSafe</code>æä¾›äº† URL å®‰å…¨çš„ Base64 ç¼–ç æ–¹å¼ï¼ˆå°†+ å’Œ /æ›¿æ¢ä¸º - å’Œ _ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.zp.javase.security.encrypt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Base64Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">        String url = <span class="string">"https://www.baidu.com/s?wd=Base64&amp;rsv_spt=1&amp;rsv_iqid=0xa9188d560005131f&amp;issp=1&amp;f=3&amp;rsv_bp=0&amp;rsv_idx=2&amp;ie=utf-8&amp;tn=baiduhome_pg&amp;rsv_enter=1&amp;rsv_sug3=1&amp;rsv_sug1=1&amp;rsv_sug7=001&amp;rsv_sug2=1&amp;rsp=0&amp;rsv_sug9=es_2_1&amp;rsv_sug4=2153&amp;rsv_sug=9"</span>;</span><br><span class="line">        <span class="comment">// byte[] encoded = Base64.encodeBase64(url.getBytes("UTF8")); // æ ‡å‡†çš„Base64ç¼–ç </span></span><br><span class="line">        <span class="keyword">byte</span>[] encoded = Base64.encodeBase64URLSafe(url.getBytes(<span class="string">"UTF8"</span>)); <span class="comment">// URLå®‰å…¨çš„Base64ç¼–ç </span></span><br><span class="line">        <span class="keyword">byte</span>[] decoded = Base64.decodeBase64(encoded);</span><br><span class="line">        System.out.println(<span class="string">"url:"</span> + url);</span><br><span class="line">        System.out.println(<span class="string">"encoded:"</span> + <span class="keyword">new</span> String(encoded));</span><br><span class="line">        System.out.println(<span class="string">"decoded:"</span> + <span class="keyword">new</span> String(decoded));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¯¹ç§°åŠ å¯†"><a class="markdownIt-Anchor" href="#å¯¹ç§°åŠ å¯†"></a> å¯¹ç§°åŠ å¯†</h2>
<h3 id="ç®—æ³•ç®€è¿°-2"><a class="markdownIt-Anchor" href="#ç®—æ³•ç®€è¿°-2"></a> ç®—æ³•ç®€è¿°</h3>
<p>å¯¹ç§°åŠ å¯†ç®—æ³•æ˜¯åº”ç”¨è¾ƒæ—©çš„åŠ å¯†ç®—æ³•ï¼ŒæŠ€æœ¯æˆç†Ÿã€‚åœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œæ•°æ®å‘ä¿¡æ–¹å°†æ˜æ–‡ï¼ˆåŸå§‹æ•°æ®ï¼‰å’ŒåŠ å¯†å¯†é’¥ï¼ˆmi yaoï¼‰ä¸€èµ·ç»è¿‡ç‰¹æ®ŠåŠ å¯†ç®—æ³•å¤„ç†åï¼Œä½¿å…¶å˜æˆå¤æ‚çš„åŠ å¯†å¯†æ–‡å‘é€å‡ºå»ã€‚æ”¶ä¿¡æ–¹æ”¶åˆ°å¯†æ–‡åï¼Œè‹¥æƒ³è§£è¯»åŸæ–‡ï¼Œåˆ™éœ€è¦ä½¿ç”¨åŠ å¯†ç”¨è¿‡çš„å¯†é’¥åŠç›¸åŒç®—æ³•çš„é€†ç®—æ³•å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œæ‰èƒ½ä½¿å…¶æ¢å¤æˆå¯è¯»æ˜æ–‡ã€‚åœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œä½¿ç”¨çš„å¯†é’¥åªæœ‰ä¸€ä¸ªï¼Œå‘æ”¶ä¿¡åŒæ–¹éƒ½ä½¿ç”¨è¿™ä¸ªå¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œè¿™å°±è¦æ±‚è§£å¯†æ–¹äº‹å…ˆå¿…é¡»çŸ¥é“åŠ å¯†å¯†é’¥ã€‚</p>
<h4 id="ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹"></a> ç‰¹ç‚¹</h4>
<h5 id="ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#ä¼˜ç‚¹"></a> ä¼˜ç‚¹ï¼š</h5>
<p>è®¡ç®—é‡å°ã€åŠ å¯†é€Ÿåº¦å¿«ã€åŠ å¯†æ•ˆç‡é«˜ã€‚</p>
<h5 id="ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#ç¼ºç‚¹"></a> ç¼ºç‚¹ï¼š</h5>
<p>ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œå®‰å…¨æ€§å¾—ä¸åˆ°ä¿è¯ã€‚</p>
<p>é€šä¿¡åŒæ–¹æ¯æ¬¡ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•æ—¶ï¼Œéƒ½éœ€è¦ä½¿ç”¨å…¶ä»–äººä¸çŸ¥é“çš„æƒŸä¸€å¯†é’¥ï¼Œè¿™ä¼šä½¿å¾—é€šä¿¡åŒæ–¹æ‰€æ‹¥æœ‰çš„å¯†é’¥æ•°é‡å‘ˆå‡ ä½•çº§æ•°å¢é•¿ï¼Œå¯†é’¥ç®¡ç†æˆä¸ºç”¨æˆ·çš„è´Ÿæ‹…ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•åœ¨åˆ†å¸ƒå¼ç½‘ç»œç³»ç»Ÿä¸Šä½¿ç”¨è¾ƒä¸ºå›°éš¾ï¼Œä¸»è¦æ˜¯å› ä¸ºå¯†é’¥ç®¡ç†å›°éš¾ï¼Œä½¿ç”¨æˆæœ¬è¾ƒé«˜ã€‚</p>
<p>è€Œä¸å…¬é’¥ã€å¯†é’¥åŠ å¯†ç®—æ³•æ¯”èµ·æ¥ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•èƒ½å¤Ÿæä¾›åŠ å¯†å’Œè®¤è¯å´ç¼ºä¹äº†ç­¾ååŠŸèƒ½ï¼Œä½¿å¾—ä½¿ç”¨èŒƒå›´æœ‰æ‰€ç¼©å°ã€‚</p>
<h4 id="åŸç†-2"><a class="markdownIt-Anchor" href="#åŸç†-2"></a> åŸç†</h4>
<p>å¯¹ç§°åŠ å¯†è¦æ±‚åŠ å¯†ä¸è§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼Œè§£å¯†æ˜¯åŠ å¯†çš„é€†è¿ç®—ã€‚ç”±äºåŠ å¯†ã€è§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼Œè¿™è¦æ±‚é€šä¿¡åŒæ–¹å¿…é¡»åœ¨é€šä¿¡å‰å•†å®šè¯¥å¯†é’¥ï¼Œå¹¶å¦¥å–„ä¿å­˜è¯¥å¯†é’¥ã€‚</p>
<p>å¯¹ç§°åŠ å¯†ä½“åˆ¶åˆ†ä¸ºä¸¤ç§ï¼š</p>
<p>ä¸€ç§æ˜¯å¯¹æ˜æ–‡çš„å•ä¸ªä½ï¼ˆæˆ–å­—èŠ‚ï¼‰è¿›è¡Œè¿ç®—ï¼Œç§°ä¸ºæµå¯†ç ï¼Œä¹Ÿç§°ä¸ºåºåˆ—å¯†ç ï¼›</p>
<p>ä¸€ç§æ˜¯æŠŠæ˜æ–‡ä¿¡æ¯åˆ’åˆ†ä¸ºä¸åŒçš„ç»„ï¼ˆæˆ–å—ï¼‰ç»“æ„ï¼Œåˆ†åˆ«å¯¹æ¯ä¸ªç»„ï¼ˆæˆ–å—ï¼‰è¿›è¡ŒåŠ å¯†ã€è§£å¯†ï¼Œç§°ä¸ºåˆ†ç»„å¯†ç ã€‚</p>
<p><br><div align="center"><img src="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/symmetric-encryption.png"></div><br></p>
<p>å‡è®¾ç”²ä¹™æ–¹ä½œä¸ºé€šä¿¡åŒæ–¹ã€‚å‡å®šç”²ä¹™åŒæ–¹åœ¨æ¶ˆæ¯ä¼ é€’å‰å·²å•†å®šåŠ å¯†ç®—æ³•ï¼Œæ¬²å®Œæˆä¸€æ¬¡æ¶ˆæ¯ä¼ é€’éœ€è¦ç»è¿‡å¦‚ä¸‹æ­¥éª¤ã€‚</p>
<p><br><div align="center"><img src="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/symmetric-encryption-progress.png"></div><br></p>
<h4 id="å·¥ä½œæ¨¡å¼"><a class="markdownIt-Anchor" href="#å·¥ä½œæ¨¡å¼"></a> å·¥ä½œæ¨¡å¼</h4>
<p>ä»¥ DES ç®—æ³•çš„å·¥ä½œæ¨¡å¼ä¸ºä¾‹ï¼ŒDES ç®—æ³•æ ¹æ®å…¶åŠ å¯†ç®—æ³•æ‰€å®šä¹‰çš„æ˜æ–‡åˆ†ç»„çš„å¤§å°ï¼ˆ56 ä½ï¼‰ï¼Œå°†æ•°æ®åˆ†å‰²æˆè‹¥å¹² 56 ä½çš„åŠ å¯†åŒºå—ï¼Œå†ä»¥åŠ å¯†åŒºå—ä¸ºå•ä½ï¼Œåˆ†åˆ«è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚å¦‚æœæœ€åå‰©ä¸‹ä¸è¶³ä¸€ä¸ªåŒºå—çš„å¤§å°ï¼Œç§°ä¹‹ä¸º<strong>çŸ­å—</strong>ã€‚çŸ­å—çš„å¤„ç†æ–¹æ³•æœ‰å¡«å……æ³•ã€æµå¯†ç åŠ å¯†æ³•ã€å¯†æ–‡æŒªç”¨æŠ€æœ¯ã€‚</p>
<p>æ ¹æ®æ•°æ®åŠ å¯†æ—¶æ¯ä¸ªåŠ å¯†åŒºå—è§å¾—å…³è”æ–¹å¼æ¥åŒºåˆ†ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ç§å·¥ä½œæ¨¡å¼ï¼š</p>
<p><strong>(1) ç”µå­å¯†ç æœ¬æ¨¡å¼(Electronic Code Book, ECB)</strong></p>
<p>ç”¨é€”ï¼šé€‚åˆåŠ å¯†å¯†é’¥ï¼Œéšæœºæ•°ç­‰çŸ­æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå®‰å…¨åœ°ä¼ é€’ DES å¯†é’¥ï¼ŒECB æ˜¯æœ€åˆé€‚çš„æ¨¡å¼ã€‚</p>
<p><strong>(2) å¯†æ–‡é“¾æ¥æ¨¡å¼(Cipher Booki Chaining, CBC)</strong></p>
<p>ç”¨é€”ï¼šå¯åŠ å¯†ä»»æ„é•¿åº¦çš„æ•°æ®ï¼Œé€‚ç”¨äºè®¡ç®—äº§ç”Ÿæ£€æµ‹æ•°æ®å®Œæ•´æ€§çš„æ¶ˆæ¯è®¤è¯ MACã€‚</p>
<p><strong>(3) å¯†æ–‡åé¦ˆæ¨¡å¼(Cipher Feed Back, CFB)</strong></p>
<p>ç”¨é€”ï¼šå› é”™è¯¯ä¼ æ’­æ— ç•Œï¼Œå¯ä»¥ç”¨äºæ£€æŸ¥å‘ç°æ˜æ–‡å¯†æ–‡çš„ç¯¡æ”¹ã€‚</p>
<p><strong>(4) è¾“å‡ºåé¦ˆæ¨¡å¼(Output Feed Back, OFB)</strong></p>
<p>ç”¨é€”ï¼šä½¿ç”¨äºåŠ å¯†å†—ä½™æ€§è¾ƒå¤§çš„æ•°æ®ï¼Œæ¯”å¦‚è¯­éŸ³å’Œå›¾åƒæ•°æ®ã€‚</p>
<p>AES ç®—æ³•é™¤äº†ä»¥ä¸Š 4 ä¸­æ¨¡å¼å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ–°çš„å·¥ä½œæ¨¡å¼ï¼š</p>
<p><strong>(5) è®¡æ•°å™¨æ¨¡å¼(Counter, CTR)</strong></p>
<p>ç”¨é€”ï¼šé€‚ç”¨äºå„ç§åŠ å¯†åº”ç”¨ã€‚</p>
<p>æœ¬æ–‡å¯¹äºå„ç§å·¥ä½œæ¨¡å¼çš„åŸç†å±•å¼€æè¿°ã€‚ä¸ªäººè®¤ä¸ºï¼Œä½œä¸ºå·¥ç¨‹åº”ç”¨ï¼Œäº†è§£å…¶ç”¨é€”å³å¯ã€‚</p>
<h4 id="å¡«å……æ–¹æ³•"><a class="markdownIt-Anchor" href="#å¡«å……æ–¹æ³•"></a> å¡«å……æ–¹æ³•</h4>
<p>Java ä¸­å¯¹ç§°åŠ å¯†å¯¹äºçŸ­å—çš„å¤„ç†ï¼Œä¸€èˆ¬æ˜¯é‡‡ç”¨å¡«å……æ–¹å¼ã€‚</p>
<p>å¸¸é‡‡ç”¨çš„æ˜¯ï¼šNoPaddingï¼ˆä¸å¡«å……ï¼‰ã€Zeros å¡«å……ï¼ˆ0 å¡«å……ï¼‰ã€PKCS5Padding å¡«å……ã€‚</p>
<p><strong>ZerosPadding</strong></p>
<p>æ–¹å¼ï¼šå…¨éƒ¨å¡«å……ä¸º 0 çš„å­—èŠ‚</p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p>F1 F2 F3 F4 F5 F6 F7 F8 //ç¬¬ä¸€å—</p>
<p>F9 00 00 00 00 00 00 00 //ç¬¬äºŒå—</p>
<p><strong>PKCS5Padding</strong></p>
<p>æ–¹å¼ï¼šæ¯ä¸ªå¡«å……çš„å­—èŠ‚éƒ½è®°å½•äº†å¡«å……çš„æ€»å­—èŠ‚æ•°</p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p>F1 F2 F3 F4 F5 F6 F7 F8 //ç¬¬ä¸€å—</p>
<p>F9 07 07 07 07 07 07 07 //ç¬¬äºŒå—</p>
<h4 id="å¸¸ç”¨ç®—æ³•"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç®—æ³•"></a> å¸¸ç”¨ç®—æ³•</h4>
<p>å¯¹ç§°åŠ å¯†ç®—æ³•ä¸»è¦æœ‰ DESã€3DESï¼ˆTripleDESï¼‰ã€AESã€IDEAã€RC2ã€RC4ã€RC5 å’Œ Blowfish ç­‰ã€‚</p>
<h3 id="ç®—æ³•å®ç°-2"><a class="markdownIt-Anchor" href="#ç®—æ³•å®ç°-2"></a> ç®—æ³•å®ç°</h3>
<h4 id="åŸºäºå¯†é’¥åŠ å¯†çš„æµç¨‹des-desede-aes-å’Œ-idea"><a class="markdownIt-Anchor" href="#åŸºäºå¯†é’¥åŠ å¯†çš„æµç¨‹des-desede-aes-å’Œ-idea"></a> åŸºäºå¯†é’¥åŠ å¯†çš„æµç¨‹ï¼ˆDESã€DESedeã€AES å’Œ IDEAï¼‰</h4>
<p>DESã€DESedeã€AES å’Œ IDEA ç­‰ç®—æ³•éƒ½æ˜¯åŸºäºå¯†é’¥åŠ å¯†çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå®ƒä»¬çš„å®ç°æµç¨‹ä¹ŸåŸºæœ¬ä¸€è‡´ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰ç”Ÿæˆå¯†é’¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">KeyGenerator kg = KeyGenerator.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">SecureRandom random = <span class="keyword">new</span> SecureRandom();</span><br><span class="line">kg.init(random);</span><br><span class="line">SecretKey secretKey = kg.generateKey();</span><br></pre></td></tr></table></figure>
<p>å»ºè®®ä½¿ç”¨éšæœºæ•°æ¥åˆå§‹åŒ–å¯†é’¥çš„ç”Ÿæˆã€‚</p>
<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–å¯†ç å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Cipher cipher = Cipher.getInstance(<span class="string">"DES/ECB/PKCS5Padding"</span>);</span><br><span class="line">cipher.init(Cipher.ENCRYPT_MODE, secretKey);</span><br></pre></td></tr></table></figure>
<p><code>ENCRYPT_MODE</code>ï¼šåŠ å¯†æ¨¡å¼</p>
<p><code>DECRYPT_MODE</code>ï¼šè§£å¯†æ¨¡å¼</p>
<p>ï¼ˆ3ï¼‰æ‰§è¡Œ</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">String plaintext = <span class="string">"Hello World"</span>;</span><br><span class="line">byte<span class="literal">[]</span> ciphertext = cipher.<span class="keyword">do</span><span class="constructor">Final(<span class="params">plaintext</span>.<span class="params">getBytes</span>()</span>);</span><br></pre></td></tr></table></figure>
<h5 id="å®Œæ•´å®ä¾‹"><a class="markdownIt-Anchor" href="#å®Œæ•´å®ä¾‹"></a> å®Œæ•´å®ä¾‹</h5>
<p>ä¸€ä¸ªå®Œæ•´çš„ DES åŠ å¯†è§£å¯†èŒƒä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.bouncycastle.util.encoders.Base64;</span><br><span class="line"><span class="keyword">import</span> org.zp.javase.security.encode.Encode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchProviderException;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span> DESCoder</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> DESå®‰å…¨ç¼–ç ï¼šæ˜¯ç»å…¸çš„å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å¯†é’¥ä»…56ä½ï¼Œä¸”è¿­ä»£æ¬¡æ•°åå°‘ã€‚å·²è¢«è§†ä¸ºå¹¶ä¸å®‰å…¨çš„åŠ å¯†ç®—æ³•ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Victor Zhang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2016å¹´7æœˆ14æ—¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DESCoder</span> <span class="keyword">implements</span> <span class="title">Encode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String KEY_ALGORITHM_DES = <span class="string">"DES"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CIPHER_DES_DEFAULT = <span class="string">"DES"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CIPHER_DES_ECB_PKCS5PADDING = <span class="string">"DES/ECB/PKCS5Padding"</span>; <span class="comment">// ç®—æ³•/æ¨¡å¼/è¡¥ç æ–¹å¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CIPHER_DES_CBC_PKCS5PADDING = <span class="string">"DES/CBC/PKCS5Padding"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CIPHER_DES_CBC_NOPADDING = <span class="string">"DES/CBC/NoPadding"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SEED = <span class="string">"%%%today is nice***"</span>; <span class="comment">// ç”¨äºç”Ÿæˆéšæœºæ•°çš„ç§å­</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Key key;</span><br><span class="line">    <span class="keyword">private</span> Cipher cipher;</span><br><span class="line">    <span class="keyword">private</span> String transformation;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DESCoder</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchAlgorithmException, NoSuchPaddingException, NoSuchProviderException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.key = initKey();</span><br><span class="line">        <span class="keyword">this</span>.cipher = Cipher.getInstance(CIPHER_DES_DEFAULT);</span><br><span class="line">        <span class="keyword">this</span>.transformation = CIPHER_DES_DEFAULT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DESCoder</span><span class="params">(String transformation)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> NoSuchAlgorithmException, NoSuchPaddingException, NoSuchProviderException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.key = initKey();</span><br><span class="line">        <span class="keyword">this</span>.cipher = Cipher.getInstance(transformation);</span><br><span class="line">        <span class="keyword">this</span>.transformation = transformation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Title</span> decrypt</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> è§£å¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Victor Zhang</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 2016å¹´7æœˆ20æ—¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input å¯†æ–‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> byte[] æ˜æ–‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidKeyException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalBlockSizeException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> BadPaddingException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidAlgorithmParameterException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] decrypt(<span class="keyword">byte</span>[] input) <span class="keyword">throws</span> InvalidKeyException, IllegalBlockSizeException, BadPaddingException,</span><br><span class="line">            InvalidAlgorithmParameterException &#123;</span><br><span class="line">        <span class="keyword">if</span> (transformation.equals(CIPHER_DES_CBC_PKCS5PADDING) || transformation.equals(CIPHER_DES_CBC_NOPADDING)) &#123;</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, key, <span class="keyword">new</span> IvParameterSpec(getIV()));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Title</span> encrypt</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> åŠ å¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Victor Zhang</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 2016å¹´7æœˆ20æ—¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input æ˜æ–‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> byte[] å¯†æ–‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidKeyException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalBlockSizeException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> BadPaddingException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidAlgorithmParameterException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] encrypt(<span class="keyword">byte</span>[] input) <span class="keyword">throws</span> InvalidKeyException, IllegalBlockSizeException, BadPaddingException,</span><br><span class="line">            InvalidAlgorithmParameterException &#123;</span><br><span class="line">        <span class="keyword">if</span> (transformation.equals(CIPHER_DES_CBC_PKCS5PADDING) || transformation.equals(CIPHER_DES_CBC_NOPADDING)) &#123;</span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, key, <span class="keyword">new</span> IvParameterSpec(getIV()));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Title</span> initKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> æ ¹æ®éšæœºæ•°ç§å­ç”Ÿæˆä¸€ä¸ªå¯†é’¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Victor Zhang</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 2016å¹´7æœˆ14æ—¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Return</span> Key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchAlgorithmException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchProviderException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Key <span class="title">initKey</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchAlgorithmException, NoSuchProviderException </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®ç§å­ç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„éšæœºæ•°</span></span><br><span class="line">        SecureRandom secureRandom = <span class="keyword">null</span>;</span><br><span class="line">        secureRandom = <span class="keyword">new</span> SecureRandom(SEED.getBytes());</span><br><span class="line"></span><br><span class="line">        KeyGenerator keyGen = KeyGenerator.getInstance(KEY_ALGORITHM_DES);</span><br><span class="line">        keyGen.init(secureRandom);</span><br><span class="line">        <span class="keyword">return</span> keyGen.generateKey();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] getIV() &#123;</span><br><span class="line">        String iv = <span class="string">"01234567"</span>; <span class="comment">// IV length: must be 8 bytes long</span></span><br><span class="line">        <span class="keyword">return</span> iv.getBytes();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        DESCoder aes = <span class="keyword">new</span> DESCoder(CIPHER_DES_CBC_PKCS5PADDING);</span><br><span class="line"></span><br><span class="line">        String msg = <span class="string">"Hello World!"</span>;</span><br><span class="line">        System.out.println(<span class="string">"åŸæ–‡: "</span> + msg);</span><br><span class="line">        <span class="keyword">byte</span>[] encoded = aes.encrypt(msg.getBytes(<span class="string">"UTF8"</span>));</span><br><span class="line">        String encodedBase64 = Base64.toBase64String(encoded);</span><br><span class="line">        System.out.println(<span class="string">"å¯†æ–‡: "</span> + encodedBase64);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] decodedBase64 = Base64.decode(encodedBase64);</span><br><span class="line">        <span class="keyword">byte</span>[] decoded = aes.decrypt(decodedBase64);</span><br><span class="line">        System.out.println(<span class="string">"æ˜æ–‡: "</span> + <span class="keyword">new</span> String(decoded));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">åŸæ–‡: Hello World!</span></span><br><span class="line"><span class="section">å¯†æ–‡: TtnEu9ezNQtxFKpmq/37Qw==</span></span><br><span class="line"><span class="section">æ˜æ–‡: Hello World!</span></span><br></pre></td></tr></table></figure>
<h4 id="åŸºäºå£ä»¤åŠ å¯†çš„æµç¨‹pbe"><a class="markdownIt-Anchor" href="#åŸºäºå£ä»¤åŠ å¯†çš„æµç¨‹pbe"></a> åŸºäºå£ä»¤åŠ å¯†çš„æµç¨‹ï¼ˆPBEï¼‰</h4>
<p>DESã€DESedeã€AESã€IDEA è¿™å‡ ç§ç®—æ³•çš„åº”ç”¨æ¨¡å‹å‡ ä¹å¦‚å‡ºä¸€è¾™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¹¶éæ‰€æœ‰å¯¹ç§°åŠ å¯†ç®—æ³•éƒ½æ˜¯å¦‚æ­¤ã€‚</p>
<p>åŸºäºå£ä»¤åŠ å¯†(Password Based Encryption, PBE)æ˜¯ä¸€ç§åŸºäºå£ä»¤åŠ å¯†çš„ç®—æ³•ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼šå£ä»¤ç”±ç”¨æˆ·è‡ªå·±æŒç®¡ï¼Œé‡‡ç”¨éšæœºæ•°ï¼ˆè¿™é‡Œå«åšç›ï¼‰æ‚å‡‘å¤šé‡åŠ å¯†ç­‰æ–¹æ³•ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</p>
<p>PBE æ²¡æœ‰å¯†é’¥æ¦‚å¿µï¼Œå¯†é’¥åœ¨å…¶ä»–å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­æ˜¯ç»è¿‡è®¡ç®—å¾—å‡ºçš„ï¼ŒPBE åˆ™ä½¿ç”¨å£ä»¤æ›¿ä»£äº†å¯†é’¥ã€‚</p>
<p>æµç¨‹ï¼š</p>
<p><br><div align="center"><img src="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/password-based-encryption-progress.png"></div><br></p>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰äº§ç”Ÿç›</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">SecureRandom secureRandom = <span class="keyword">new</span> SecureRandom();</span><br><span class="line"><span class="keyword">byte</span>[] salt = secureRandom.generateSeed(<span class="number">8</span>); <span class="comment">// ç›é•¿åº¦å¿…é¡»ä¸º8å­—èŠ‚</span></span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰æ ¹æ®å¯†ç äº§ç”Ÿ Key</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String password = <span class="string">"123456"</span>;</span><br><span class="line">PBEKeySpec keySpec = <span class="keyword">new</span> PBEKeySpec(password.toCharArray());</span><br><span class="line">SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">SecretKey secretKey = keyFactory.generateSecret(keySpec);</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰åˆå§‹åŒ–åŠ å¯†æˆ–è§£å¯†å¯¹è±¡</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PBEParameterSpec paramSpec = <span class="keyword">new</span> PBEParameterSpec(salt, ITERATION_COUNT);</span><br><span class="line">Cipher cipher = Cipher.getInstance(KEY_ALGORITHM);</span><br><span class="line">cipher.init(Cipher.ENCRYPT_MODE, secretKey, paramSpec);</span><br></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰æ‰§è¡Œ</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] plaintext = <span class="string">"Hello World"</span>.getBytes();</span><br><span class="line"><span class="keyword">byte</span>[] ciphertext = cipher.doFinal(plaintext);</span><br></pre></td></tr></table></figure>
<h2 id="éå¯¹ç§°åŠ å¯†"><a class="markdownIt-Anchor" href="#éå¯¹ç§°åŠ å¯†"></a> éå¯¹ç§°åŠ å¯†</h2>
<h3 id="ç®—æ³•ç®€è¿°-3"><a class="markdownIt-Anchor" href="#ç®—æ³•ç®€è¿°-3"></a> ç®—æ³•ç®€è¿°</h3>
<p>éå¯¹ç§°åŠ å¯†ç®—æ³•å’Œå¯¹ç§°åŠ å¯†ç®—æ³•çš„ä¸»è¦å·®åˆ«åœ¨äºéå¯¹ç§°åŠ å¯†ç®—æ³•ç”¨äºåŠ å¯†å’Œè§£å¯†çš„å¯†é’¥æ˜¯ä¸åŒçš„ã€‚ä¸€ä¸ªå…¬å¼€ï¼Œç§°ä¸ºå…¬é’¥ï¼ˆpublic keyï¼‰ï¼›ä¸€ä¸ªä¿å¯†ï¼Œç§°ä¸ºç§é’¥ï¼ˆprivate keyï¼‰ã€‚å› æ­¤ï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•ä¹Ÿç§°ä¸ºåŒé’¥åŠ å¯†ç®—æ³•æˆ–å…¬é’¥åŠ å¯†ç®—æ³•ã€‚</p>
<h4 id="ç‰¹ç‚¹-2"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹-2"></a> ç‰¹ç‚¹</h4>
<h5 id="ä¼˜ç‚¹-2"><a class="markdownIt-Anchor" href="#ä¼˜ç‚¹-2"></a> ä¼˜ç‚¹</h5>
<p>éå¯¹ç§°åŠ å¯†ç®—æ³•è§£å†³äº†å¯¹ç§°åŠ å¯†ç®—æ³•çš„å¯†é’¥åˆ†é…é—®é¢˜ï¼Œå¹¶æå¤§åœ°æé«˜äº†ç®—æ³•å®‰å…¨æ€§ã€‚</p>
<h5 id="ç¼ºç‚¹-2"><a class="markdownIt-Anchor" href="#ç¼ºç‚¹-2"></a> ç¼ºç‚¹</h5>
<p>ç®—æ³•æ¯”å¯¹ç§°ç®—æ³•æ›´å¤æ‚ï¼Œå› æ­¤åŠ å¯†ã€è§£å¯†é€Ÿåº¦éƒ½æ¯”å¯¹ç§°ç®—æ³•æ…¢å¾ˆå¤šã€‚</p>
<h4 id="åŸç†-3"><a class="markdownIt-Anchor" href="#åŸç†-3"></a> åŸç†</h4>
<p><br><div align="center"><img src="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/asymmetric-encryption.png"></div><br></p>
<p>éå¯¹ç§°åŠ å¯†ç®—æ³•å®ç°æœºå¯†ä¿¡æ¯äº¤æ¢çš„åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼šç”²æ–¹ç”Ÿæˆä¸€å¯¹å¯†é’¥å¹¶å°†å…¶ä¸­çš„ä¸€æŠŠä½œä¸ºå…¬ç”¨å¯†é’¥å‘å…¶å®ƒæ–¹å…¬å¼€ï¼›å¾—åˆ°è¯¥å…¬ç”¨å¯†é’¥çš„ä¹™æ–¹ä½¿ç”¨è¯¥å¯†é’¥å¯¹æœºå¯†ä¿¡æ¯è¿›è¡ŒåŠ å¯†åå†å‘é€ç»™ç”²æ–¹ï¼›ç”²æ–¹å†ç”¨è‡ªå·±ä¿å­˜çš„å¦ä¸€æŠŠä¸“ç”¨å¯†é’¥å¯¹åŠ å¯†åçš„ä¿¡æ¯è¿›è¡Œè§£å¯†ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œç”²æ–¹å¯ä»¥ä½¿ç”¨ä¹™æ–¹çš„å…¬é’¥å¯¹æœºå¯†ä¿¡æ¯è¿›è¡Œç­¾ååå†å‘é€ç»™ä¹™æ–¹ï¼›ä¹™æ–¹å†ç”¨è‡ªå·±çš„ç§åŒ™å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ã€‚</p>
<p>ç”²æ–¹åªèƒ½ç”¨å…¶ç§é’¥è§£å¯†ï¼Œç”±å…¶å…¬é’¥åŠ å¯†åçš„ä»»ä½•ä¿¡æ¯ã€‚ éå¯¹ç§°åŠ å¯†ç®—æ³•çš„ä¿å¯†æ€§æ¯”è¾ƒå¥½ï¼Œå®ƒæ¶ˆé™¤äº†æœ€ç»ˆç”¨æˆ·äº¤æ¢å¯†é’¥çš„éœ€è¦ã€‚</p>
<h4 id="å¸¸ç”¨ç®—æ³•-2"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç®—æ³•-2"></a> å¸¸ç”¨ç®—æ³•</h4>
<p>DH(Diffie-Hellmanï¼Œå¯†é’¥äº¤æ¢ç®—æ³•)ã€RSA</p>
<h3 id="ç®—æ³•å®ç°-3"><a class="markdownIt-Anchor" href="#ç®—æ³•å®ç°-3"></a> ç®—æ³•å®ç°</h3>
<h4 id="å®Œæ•´èŒƒä¾‹"><a class="markdownIt-Anchor" href="#å®Œæ•´èŒƒä¾‹"></a> å®Œæ•´èŒƒä¾‹</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSACoder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String KEY_ALGORITHM = <span class="string">"RSA"</span>;</span><br><span class="line">    <span class="keyword">private</span> KeyPair keyPair;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RSACoder</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.keyPair = initKeyPair();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] encryptByPublicKey(<span class="keyword">byte</span>[] plaintext, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(key);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PublicKey publicKey = keyFactory.generatePublic(keySpec);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(plaintext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] encryptByPrivateKey(<span class="keyword">byte</span>[] plaintext, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(key);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PrivateKey privateKey = keyFactory.generatePrivate(keySpec);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, privateKey);</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(plaintext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] decryptByPublicKey(<span class="keyword">byte</span>[] ciphertext, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(key);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PublicKey publicKey = keyFactory.generatePublic(keySpec);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, publicKey);</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(ciphertext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] decryptByPrivateKey(<span class="keyword">byte</span>[] ciphertext, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(key);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PrivateKey privateKey = keyFactory.generatePrivate(keySpec);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line">        <span class="keyword">return</span> cipher.doFinal(ciphertext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> KeyPair <span class="title">initKeyPair</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// KeyPairGeneratorç±»ç”¨äºç”Ÿæˆå…¬é’¥å’Œç§é’¥å¯¹ï¼ŒåŸºäºRSAç®—æ³•ç”Ÿæˆå¯¹è±¡</span></span><br><span class="line">        KeyPairGenerator keyPairGen = KeyPairGenerator.getInstance(KEY_ALGORITHM);</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨ï¼Œå¯†é’¥å¤§å°ä¸º1024ä½</span></span><br><span class="line">        keyPairGen.initialize(<span class="number">1024</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆä¸€ä¸ªå¯†é’¥å¯¹</span></span><br><span class="line">        <span class="keyword">return</span> keyPairGen.genKeyPair();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String msg = <span class="string">"Hello World!"</span>;</span><br><span class="line">        RSACoder coder = <span class="keyword">new</span> RSACoder();</span><br><span class="line">        <span class="comment">// ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†</span></span><br><span class="line">        <span class="keyword">byte</span>[] ciphertext = coder.encryptByPrivateKey(msg.getBytes(<span class="string">"UTF8"</span>), coder.keyPair.getPrivate().getEncoded());</span><br><span class="line">        <span class="keyword">byte</span>[] plaintext = coder.decryptByPublicKey(ciphertext, coder.keyPair.getPublic().getEncoded());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†</span></span><br><span class="line">        <span class="keyword">byte</span>[] ciphertext2 = coder.encryptByPublicKey(msg.getBytes(), coder.keyPair.getPublic().getEncoded());</span><br><span class="line">        <span class="keyword">byte</span>[] plaintext2 = coder.decryptByPrivateKey(ciphertext2, coder.keyPair.getPrivate().getEncoded());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"åŸæ–‡ï¼š"</span> + msg);</span><br><span class="line">        System.out.println(<span class="string">"å…¬é’¥ï¼š"</span> + Base64.encodeBase64URLSafeString(coder.keyPair.getPublic().getEncoded()));</span><br><span class="line">        System.out.println(<span class="string">"ç§é’¥ï¼š"</span> + Base64.encodeBase64URLSafeString(coder.keyPair.getPrivate().getEncoded()));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"============== ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯† =============="</span>);</span><br><span class="line">        System.out.println(<span class="string">"å¯†æ–‡ï¼š"</span> + Base64.encodeBase64URLSafeString(ciphertext));</span><br><span class="line">        System.out.println(<span class="string">"æ˜æ–‡ï¼š"</span> + <span class="keyword">new</span> String(plaintext));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"============== å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯† =============="</span>);</span><br><span class="line">        System.out.println(<span class="string">"å¯†æ–‡ï¼š"</span> + Base64.encodeBase64URLSafeString(ciphertext2));</span><br><span class="line">        System.out.println(<span class="string">"æ˜æ–‡ï¼š"</span> + <span class="keyword">new</span> String(plaintext2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">åŸæ–‡ï¼šHello World!</span><br><span class="line">å…¬é’¥ï¼šMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCVN2mWAMdatpo2l8dwavaX2VC8mRleVTdjwjyahsyCE6UxkdqHsKD6Ecq3OBbuJhEfHxnr7MAD_zoE6zalFs7_si09XTgpVFsFCztPXJpPw-rpQdvaaxYEXJHkY07M_DBrxh1URg2gQl9dEDaruIFrZ12ugTwwEkLA1K_LN7yZrwIDAQAB</span><br><span class="line">ç§é’¥ï¼šMIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAJU3aZYAx1q2mjaXx3Bq9pfZULyZGV5VN2PCPJqGzIITpTGR2oewoPoRyrc4Fu4mER8fGevswAP_OgTrNqUWzv-yLT1dOClUWwULO09cmk_D6ulB29prFgRckeRjTsz8MGvGHVRGDaBCX10QNqu4gWtnXa6BPDASQsDUr8s3vJmvAgMBAAECgYBvU1M8LcKOJFQzzNNoRPVLX0AEJXkuzwcvL1hFtbJYjc2eiQHwYFAJokKKpZc-ADqf7HVLdmvfz4h66P3w925hYHjSF3cs6jiibI7fc9lrdrJLMpv44phPlRCiIanD-U6pyN3bZxRl4Giuz5uGL0SVU6Dxh2Sw7mtnvUBbHCyyaQJBAOixpR-t81Qnpdy4jlbZL8ufTTF1TzlSh0NEDB4tlpHlVolVmZB2M-rdJ3nP8fJXazdsGZMP0q38vgiN2HHMtxsCQQCkKWAaA6KxKNbj0mJDSP1p4qUJ4EAcgXBz4B_PKMZa3ZU2CdmFlhlLRRTOIjZX2VC6IjHKWssa<span class="number">-3</span>V2EqBzCSz9AkBsiK9kH1anofaTBOIfUB4i86KltvnE2uGMVmjwioL4eefrFqoR35BHs<span class="number">-99</span>uag4SN4Rc7JaDb9Ot9xLUR3rtniRAkB8dFXEQx9Teie4HmaapjpgzQ_b9eQE-GjdoHvdHQeMGdMmXb9IVGwmsV<span class="number">-9</span>ixhx73IROx1OURkMArmhYyu7KqitAkBkeQ<span class="number">-7</span>AYOIROJnTUSQTMUELUmZFF1Io_SJGXyRYLgDqz7JCmmhfH7sNm8Gcn6f2VWg-U2D9-G5IHO-vHfz2DS6</span><br><span class="line">============== ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯† ==============</span><br><span class="line">å¯†æ–‡ï¼šU2otXypy1Fg4wcXK187xAuOxWM88oORVDJfaNxvG74Q_rqZ-sT4fEZYLZO80KmsWiufkJbD9Gskgkg7dRPRCwG90pRaU3PD9_sTmksN0v8MUwCX2p80zUeG3gWU6BJwMMUZrltJaHFbKn-BhzoNrn3Q<span class="number">-4</span>BJA8lt6-cKtH0TPeN4</span><br><span class="line">æ˜æ–‡ï¼šHello World!</span><br><span class="line">============== å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯† ==============</span><br><span class="line">å¯†æ–‡ï¼šO_rknvo12qaFfWieyTI_Ay8_ph49y3V4jJVs1BykpI81GM3ozCPSnOjHbtdWdjPtgJHFfCjbspAnIT2eM4PtJldIJg6k_2HZCmCCaheUj2pxcvkrhb6GdhSlH-K2FhFGAnlxUAp<span class="number">-3</span>tZpYpxzAteEw1-suldelHdikrCV_uXxAEM</span><br><span class="line">æ˜æ–‡ï¼šHello World!</span><br></pre></td></tr></table></figure>
<h2 id="æ¶ˆæ¯æ‘˜è¦"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯æ‘˜è¦"></a> æ¶ˆæ¯æ‘˜è¦</h2>
<h3 id="ç®—æ³•ç®€è¿°-4"><a class="markdownIt-Anchor" href="#ç®—æ³•ç®€è¿°-4"></a> ç®—æ³•ç®€è¿°</h3>
<h4 id="å®šä¹‰-2"><a class="markdownIt-Anchor" href="#å®šä¹‰-2"></a> å®šä¹‰</h4>
<p>å®ƒæ˜¯ä¸€ä¸ªå”¯ä¸€å¯¹åº”ä¸€ä¸ªæ¶ˆæ¯æˆ–æ–‡æœ¬çš„å›ºå®šé•¿åº¦çš„å€¼ï¼Œå®ƒç”±ä¸€ä¸ªå•å‘ Hash åŠ å¯†å‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œä½œç”¨è€Œäº§ç”Ÿã€‚å¦‚æœæ¶ˆæ¯åœ¨é€”ä¸­æ”¹å˜äº†ï¼Œåˆ™æ¥æ”¶è€…é€šè¿‡å¯¹æ”¶åˆ°æ¶ˆæ¯çš„æ–°äº§ç”Ÿçš„æ‘˜è¦ä¸åŸæ‘˜è¦æ¯”è¾ƒï¼Œå°±å¯çŸ¥é“æ¶ˆæ¯æ˜¯å¦è¢«æ”¹å˜äº†ã€‚å› æ­¤æ¶ˆæ¯æ‘˜è¦ä¿è¯äº†æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚æ¶ˆæ¯æ‘˜è¦é‡‡ç”¨å•å‘ Hash å‡½æ•°å°†éœ€åŠ å¯†çš„æ˜æ–‡&quot;æ‘˜è¦&quot;æˆä¸€ä¸²å¯†æ–‡ï¼Œè¿™ä¸€ä¸²å¯†æ–‡äº¦ç§°ä¸ºæ•°å­—æŒ‡çº¹(Finger Print)ã€‚å®ƒæœ‰å›ºå®šçš„é•¿åº¦ï¼Œä¸”ä¸åŒçš„æ˜æ–‡æ‘˜è¦æˆå¯†æ–‡ï¼Œå…¶ç»“æœæ€»æ˜¯ä¸åŒçš„ï¼Œè€ŒåŒæ ·çš„æ˜æ–‡å…¶æ‘˜è¦å¿…å®šä¸€è‡´ã€‚è¿™æ ·è¿™ä¸²æ‘˜è¦ä¾¿å¯æˆä¸ºéªŒè¯æ˜æ–‡æ˜¯å¦æ˜¯&quot;çœŸèº«&quot;çš„&quot;æŒ‡çº¹&quot;äº†ã€‚</p>
<h4 id="ç‰¹ç‚¹-3"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹-3"></a> ç‰¹ç‚¹</h4>
<p>æ¶ˆæ¯æ‘˜è¦å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å”¯ä¸€æ€§ï¼šæ•°æ®åªè¦æœ‰ä¸€ç‚¹æ”¹å˜ï¼Œé‚£ä¹ˆå†é€šè¿‡æ¶ˆæ¯æ‘˜è¦ç®—æ³•å¾—åˆ°çš„æ‘˜è¦ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚è™½ç„¶ç†è®ºä¸Šæœ‰å¯èƒ½ä¼šå‘ç”Ÿç¢°æ’ï¼Œä½†æ˜¯æ¦‚ç‡æå…¶ä½ã€‚</li>
<li>ä¸å¯é€†ï¼šæ¶ˆæ¯æ‘˜è¦ç®—æ³•çš„å¯†æ–‡æ— æ³•è¢«è§£å¯†ã€‚</li>
<li>ä¸éœ€è¦å¯†é’¥ï¼Œå¯ä½¿ç”¨äºåˆ†å¸ƒå¼ç½‘ç»œã€‚</li>
<li>æ— è®ºè¾“å…¥çš„æ˜æ–‡æœ‰å¤šé•¿ï¼Œè®¡ç®—å‡ºæ¥çš„æ¶ˆæ¯æ‘˜è¦çš„é•¿åº¦æ€»æ˜¯å›ºå®šçš„ã€‚</li>
</ul>
<h4 id="åŸç†-4"><a class="markdownIt-Anchor" href="#åŸç†-4"></a> åŸç†</h4>
<p>æ¶ˆæ¯æ‘˜è¦ï¼Œå…¶å®å°±æ˜¯å°†éœ€è¦æ‘˜è¦çš„æ•°æ®ä½œä¸ºå‚æ•°ï¼Œç»è¿‡å“ˆå¸Œå‡½æ•°(Hash)çš„è®¡ç®—ï¼Œå¾—åˆ°çš„æ•£åˆ—å€¼ã€‚</p>
<h4 id="å¸¸ç”¨ç®—æ³•-3"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç®—æ³•-3"></a> å¸¸ç”¨ç®—æ³•</h4>
<p>æ¶ˆæ¯æ‘˜è¦ç®—æ³•åŒ…æ‹¬<strong>MD(Message Digestï¼Œæ¶ˆæ¯æ‘˜è¦ç®—æ³•)</strong>ã€<strong>SHA(Secure Hash Algorithmï¼Œå®‰å…¨æ•£åˆ—ç®—æ³•)</strong>ã€**MAC(Message AuthenticationCodeï¼Œæ¶ˆæ¯è®¤è¯ç ç®—æ³•)**å…± 3 å¤§ç³»åˆ—ï¼Œå¸¸ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ˜¯æ•°å­—ç­¾åç®—æ³•çš„æ ¸å¿ƒç®—æ³•ã€‚</p>
<p><strong>MD5</strong>å’Œ<strong>SHA1</strong>åˆ†åˆ«æ˜¯<strong>MD</strong>ã€<strong>SHA</strong>ç®—æ³•ç³»åˆ—ä¸­æœ€æœ‰ä»£è¡¨æ€§çš„ç®—æ³•ã€‚</p>
<p>å¦‚ä»Šï¼ŒMD5 å·²è¢«å‘ç°æœ‰è®¸å¤šæ¼æ´ï¼Œä»è€Œä¸å†å®‰å…¨ã€‚SHA ç®—æ³•æ¯” MD ç®—æ³•çš„æ‘˜è¦é•¿åº¦æ›´é•¿ï¼Œä¹Ÿæ›´åŠ å®‰å…¨ã€‚</p>
<h3 id="ç®—æ³•å®ç°-4"><a class="markdownIt-Anchor" href="#ç®—æ³•å®ç°-4"></a> ç®—æ³•å®ç°</h3>
<h4 id="md5-sha-çš„èŒƒä¾‹"><a class="markdownIt-Anchor" href="#md5-sha-çš„èŒƒä¾‹"></a> MD5ã€SHA çš„èŒƒä¾‹</h4>
<p>JDK ä¸­ä½¿ç”¨ MD5 å’Œ SHA è¿™ä¸¤ç§æ¶ˆæ¯æ‘˜è¦çš„æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆå§‹åŒ– MessageDigest å¯¹è±¡</li>
<li>æ›´æ–°è¦è®¡ç®—çš„å†…å®¹</li>
<li>ç”Ÿæˆæ‘˜è¦</li>
</ol>
<p><strong>èŒƒä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">importjava.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MsgDigestDemo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> NoSuchAlgorithmException, UnsupportedEncodingException </span>&#123;</span><br><span class="line">        String msg = <span class="string">"Hello World!"</span>;</span><br><span class="line"></span><br><span class="line">        MessageDigest md5Digest = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">        <span class="comment">// æ›´æ–°è¦è®¡ç®—çš„å†…å®¹</span></span><br><span class="line">        md5Digest.update(msg.getBytes());</span><br><span class="line">        <span class="comment">// å®Œæˆå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°æ‘˜è¦</span></span><br><span class="line">        <span class="keyword">byte</span>[] md5Encoded = md5Digest.digest();</span><br><span class="line"></span><br><span class="line">        MessageDigest shaDigest = MessageDigest.getInstance(<span class="string">"SHA"</span>);</span><br><span class="line">        <span class="comment">// æ›´æ–°è¦è®¡ç®—çš„å†…å®¹</span></span><br><span class="line">        shaDigest.update(msg.getBytes());</span><br><span class="line">        <span class="comment">// å®Œæˆå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°æ‘˜è¦</span></span><br><span class="line">        <span class="keyword">byte</span>[] shaEncoded = shaDigest.digest();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"åŸæ–‡: "</span> + msg);</span><br><span class="line">        System.out.println(<span class="string">"MD5æ‘˜è¦: "</span> + Base64.encodeBase64URLSafeString(md5Encoded));</span><br><span class="line">        System.out.println(<span class="string">"SHAæ‘˜è¦: "</span> + Base64.encodeBase64URLSafeString(shaEncoded));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">åŸæ–‡:Hello World!</span></span><br><span class="line"><span class="section">MD5æ‘˜è¦: 7Qdih1MuhjZehB6Sv8UNjA</span></span><br><span class="line"><span class="section">SHAæ‘˜è¦:Lve95gjOVATpfV8EL5X4nxwjKHE</span></span><br></pre></td></tr></table></figure>
<h4 id="hmac-çš„èŒƒä¾‹"><a class="markdownIt-Anchor" href="#hmac-çš„èŒƒä¾‹"></a> HMAC çš„èŒƒä¾‹</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">importjavax.crypto.Mac;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HmacCoder</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDKæ”¯æŒHmacMD5, HmacSHA1,HmacSHA256, HmacSHA384, HmacSHA512</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> HmacTypeEn &#123;</span><br><span class="line">        HmacMD5, HmacSHA1, HmacSHA256, HmacSHA384, HmacSHA512;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] encode(<span class="keyword">byte</span>[] plaintext, <span class="keyword">byte</span>[] secretKey, HmacTypeEn type) throwsException &#123;</span><br><span class="line">        SecretKeySpec keySpec = <span class="keyword">new</span> SecretKeySpec(secretKey, type.name());</span><br><span class="line">        Mac mac = Mac.getInstance(keySpec.getAlgorithm());</span><br><span class="line">        mac.init(keySpec);</span><br><span class="line">        <span class="keyword">return</span> mac.doFinal(plaintext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String msg = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] secretKey = <span class="string">"Secret_Key"</span>.getBytes(<span class="string">"UTF8"</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] digest = HmacCoder.encode(msg.getBytes(), secretKey, HmacTypeEn.HmacSHA256);</span><br><span class="line">        System.out.println(<span class="string">"åŸæ–‡: "</span> + msg);</span><br><span class="line">        System.out.println(<span class="string">"æ‘˜è¦: "</span> + Base64.encodeBase64URLSafeString(digest));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">åŸæ–‡:Hello World!</span></span><br><span class="line"><span class="section">æ‘˜è¦: b8-eUifaOJ5OUFweOoq08HbGAMsIpC3Nt-Yv-S91Yr4</span></span><br></pre></td></tr></table></figure>
<h2 id="æ•°å­—ç­¾å"><a class="markdownIt-Anchor" href="#æ•°å­—ç­¾å"></a> æ•°å­—ç­¾å</h2>
<h3 id="ç®—æ³•ç®€è¿°-5"><a class="markdownIt-Anchor" href="#ç®—æ³•ç®€è¿°-5"></a> ç®—æ³•ç®€è¿°</h3>
<p>æ•°å­—ç­¾åç®—æ³•å¯ä»¥çœ‹åšæ˜¯ä¸€ç§å¸¦æœ‰å¯†é’¥çš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•ï¼Œå¹¶ä¸”è¿™ç§å¯†é’¥åŒ…å«äº†å…¬é’¥å’Œç§é’¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°å­—ç­¾åç®—æ³•æ˜¯éå¯¹ç§°åŠ å¯†ç®—æ³•å’Œæ¶ˆæ¯æ‘˜è¦ç®—æ³•çš„ç»“åˆä½“ã€‚</p>
<h4 id="ç‰¹ç‚¹-4"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹-4"></a> ç‰¹ç‚¹</h4>
<p>æ•°å­—ç­¾åç®—æ³•è¦æ±‚èƒ½å¤ŸéªŒè¯æ•°æ®å®Œæ•´æ€§ã€è®¤è¯æ•°æ®æ¥æºï¼Œå¹¶èµ·åˆ°æŠ—å¦è®¤çš„ä½œç”¨ã€‚</p>
<h4 id="åŸç†-5"><a class="markdownIt-Anchor" href="#åŸç†-5"></a> åŸç†</h4>
<p>æ•°å­—ç­¾åç®—æ³•åŒ…å«ç­¾åå’ŒéªŒè¯ä¸¤é¡¹æ“ä½œï¼Œéµå¾ªç§é’¥ç­¾åï¼Œå…¬é’¥éªŒè¯çš„æ–¹å¼ã€‚</p>
<p>ç­¾åæ—¶è¦ä½¿ç”¨ç§é’¥å’Œå¾…ç­¾åæ•°æ®ï¼ŒéªŒè¯æ—¶åˆ™éœ€è¦å…¬é’¥ã€ç­¾åå€¼å’Œå¾…ç­¾åæ•°æ®ï¼Œå…¶æ ¸å¿ƒç®—æ³•ä¸»è¦æ˜¯æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‚</p>
<p><br><div align="center"><img src="http://oyz7npk35.bkt.clouddn.com//image/javase/encode/java-message-digest-process.jpg"></div><br></p>
<h4 id="å¸¸ç”¨ç®—æ³•-4"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç®—æ³•-4"></a> å¸¸ç”¨ç®—æ³•</h4>
<p>RSAã€DSAã€ECDSA</p>
<h3 id="ç®—æ³•å®ç°-5"><a class="markdownIt-Anchor" href="#ç®—æ³•å®ç°-5"></a> ç®—æ³•å®ç°</h3>
<h4 id="dsa-çš„èŒƒä¾‹"><a class="markdownIt-Anchor" href="#dsa-çš„èŒƒä¾‹"></a> DSA çš„èŒƒä¾‹</h4>
<p>æ•°å­—ç­¾åæœ‰ä¸¤ä¸ªæµç¨‹ï¼šç­¾åå’ŒéªŒè¯ã€‚</p>
<p>å®ƒä»¬çš„å‰æéƒ½æ˜¯è¦æœ‰ä¸€ä¸ªå…¬é’¥ã€å¯†é’¥å¯¹ã€‚</p>
<p><strong>ç­¾å</strong></p>
<p>ç”¨ç§é’¥ä¸ºæ¶ˆæ¯è®¡ç®—ç­¾å</p>
<p><strong>èŒƒä¾‹</strong></p>
<p>ç”¨å…¬é’¥éªŒè¯æ‘˜è¦</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">importjava.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DsaCoder</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String KEY_ALGORITHM = <span class="string">"DSA"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> DsaTypeEn &#123;</span><br><span class="line">        MD5withDSA, SHA1withDSA</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * DSAå¯†é’¥é•¿åº¦é»˜è®¤1024ä½ã€‚ å¯†é’¥é•¿åº¦å¿…é¡»æ˜¯64çš„æ•´æ•°å€ï¼ŒèŒƒå›´åœ¨512~1024ä¹‹é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> KEY_SIZE = <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> KeyPair keyPair;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DsaCoder</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        keyPair = initKey();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] signature(<span class="keyword">byte</span>[] data, <span class="keyword">byte</span>[] privateKey) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(privateKey);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PrivateKey key =keyFactory.generatePrivate(keySpec);</span><br><span class="line"></span><br><span class="line">        Signature signature = Signature.getInstance(DsaTypeEn.SHA1withDSA.name());</span><br><span class="line">        signature.initSign(key);</span><br><span class="line">        signature.update(data);</span><br><span class="line">        <span class="keyword">return</span> signature.sign();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(<span class="keyword">byte</span>[] data, <span class="keyword">byte</span>[] publicKey, <span class="keyword">byte</span>[] sign)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(publicKey);</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</span><br><span class="line">        PublicKey key =keyFactory.generatePublic(keySpec);</span><br><span class="line"></span><br><span class="line">        Signature signature = Signature.getInstance(DsaTypeEn.SHA1withDSA.name());</span><br><span class="line">        signature.initVerify(key);</span><br><span class="line">        signature.update(data);</span><br><span class="line">        <span class="keyword">return</span> signature.verify(sign);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> KeyPair <span class="title">initKey</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span></span><br><span class="line">        KeyPairGenerator keyPairGen = KeyPairGenerator.getInstance(KEY_ALGORITHM);</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span></span><br><span class="line">        keyPairGen.initialize(KEY_SIZE);</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯†é’¥å¯¹</span></span><br><span class="line">        <span class="keyword">return</span> keyPairGen.genKeyPair();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getPublicKey() &#123;</span><br><span class="line">        <span class="keyword">return</span> keyPair.getPublic().getEncoded();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getPrivateKey() &#123;</span><br><span class="line">        <span class="keyword">return</span> keyPair.getPrivate().getEncoded();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String msg = <span class="string">"Hello World"</span>;</span><br><span class="line">        DsaCoder dsa = <span class="keyword">new</span> DsaCoder();</span><br><span class="line">        <span class="keyword">byte</span>[] sign = dsa.signature(msg.getBytes(), dsa.getPrivateKey());</span><br><span class="line">        <span class="keyword">boolean</span> flag = dsa.verify(msg.getBytes(), dsa.getPublicKey(), sign);</span><br><span class="line">        String result = flag ? <span class="string">"æ•°å­—ç­¾ååŒ¹é…"</span> : <span class="string">"æ•°å­—ç­¾åä¸åŒ¹é…"</span>;</span><br><span class="line">        System.out.println(<span class="string">"æ•°å­—ç­¾åï¼š"</span> + Base64.encodeBase64URLSafeString(sign));</span><br><span class="line">        System.out.println(<span class="string">"éªŒè¯ç»“æœï¼š"</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li>ã€ŠCore Java Volume2ã€‹</li>
<li>ã€ŠJava åŠ å¯†ä¸è§£å¯†æŠ€æœ¯ã€‹</li>
</ul>

      
    </div>

    
      


    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/programming/" rel="tag"># programming</a>
          
            <a href="/blog/tags/java/" rel="tag"># java</a>
          
            <a href="/blog/tags/javacore/" rel="tag"># javacore</a>
          
            <a href="/blog/tags/encode/" rel="tag"># encode</a>
          
            <a href="/blog/tags/encrypt/" rel="tag"># encrypt</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2016/03/20/programming/java/javastack/javatool/ide/intellij/" rel="next" title="Intellij IDEA ä½¿ç”¨å°ç»“">
                <i class="fa fa-chevron-left"></i> Intellij IDEA ä½¿ç”¨å°ç»“
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2016/10/10/tools/nginx/" rel="prev" title="Nginx æç®€æ•™ç¨‹">
                Nginx æç®€æ•™ç¨‹ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/blog/images/avatar.gif" alt="Zhang Peng">
            
              <p class="site-author-name" itemprop="name">Zhang Peng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/blog/archives/">
                
                    <span class="site-state-item-count">332</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/blog/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/blog/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">138</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/blog/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/dunwu" title="GitHub &rarr; https://github.com/dunwu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:forbreak@163.com" title="E-Mail &rarr; mailto:forbreak@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/blog/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#java-ç¼–ç å’ŒåŠ å¯†"><span class="nav-text"> Java ç¼–ç å’ŒåŠ å¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æœ¯è¯­"><span class="nav-text"> æœ¯è¯­</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#base64-ç¼–ç "><span class="nav-text"> Base64 ç¼–ç </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•ç®€è¿°"><span class="nav-text"> ç®—æ³•ç®€è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å®šä¹‰"><span class="nav-text"> å®šä¹‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†"><span class="nav-text"> åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åº”ç”¨"><span class="nav-text"> åº”ç”¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°"><span class="nav-text"> ç®—æ³•å®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¯¹ç§°åŠ å¯†"><span class="nav-text"> å¯¹ç§°åŠ å¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•ç®€è¿°-2"><span class="nav-text"> ç®—æ³•ç®€è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹ç‚¹"><span class="nav-text"> ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†-2"><span class="nav-text"> åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å·¥ä½œæ¨¡å¼"><span class="nav-text"> å·¥ä½œæ¨¡å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¡«å……æ–¹æ³•"><span class="nav-text"> å¡«å……æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¸¸ç”¨ç®—æ³•"><span class="nav-text"> å¸¸ç”¨ç®—æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°-2"><span class="nav-text"> ç®—æ³•å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºäºå¯†é’¥åŠ å¯†çš„æµç¨‹des-desede-aes-å’Œ-idea"><span class="nav-text"> åŸºäºå¯†é’¥åŠ å¯†çš„æµç¨‹ï¼ˆDESã€DESedeã€AES å’Œ IDEAï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºäºå£ä»¤åŠ å¯†çš„æµç¨‹pbe"><span class="nav-text"> åŸºäºå£ä»¤åŠ å¯†çš„æµç¨‹ï¼ˆPBEï¼‰</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#éå¯¹ç§°åŠ å¯†"><span class="nav-text"> éå¯¹ç§°åŠ å¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•ç®€è¿°-3"><span class="nav-text"> ç®—æ³•ç®€è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹ç‚¹-2"><span class="nav-text"> ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†-3"><span class="nav-text"> åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¸¸ç”¨ç®—æ³•-2"><span class="nav-text"> å¸¸ç”¨ç®—æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°-3"><span class="nav-text"> ç®—æ³•å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å®Œæ•´èŒƒä¾‹"><span class="nav-text"> å®Œæ•´èŒƒä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¶ˆæ¯æ‘˜è¦"><span class="nav-text"> æ¶ˆæ¯æ‘˜è¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•ç®€è¿°-4"><span class="nav-text"> ç®—æ³•ç®€è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å®šä¹‰-2"><span class="nav-text"> å®šä¹‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹ç‚¹-3"><span class="nav-text"> ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†-4"><span class="nav-text"> åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¸¸ç”¨ç®—æ³•-3"><span class="nav-text"> å¸¸ç”¨ç®—æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°-4"><span class="nav-text"> ç®—æ³•å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#md5-sha-çš„èŒƒä¾‹"><span class="nav-text"> MD5ã€SHA çš„èŒƒä¾‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hmac-çš„èŒƒä¾‹"><span class="nav-text"> HMAC çš„èŒƒä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°å­—ç­¾å"><span class="nav-text"> æ•°å­—ç­¾å</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•ç®€è¿°-5"><span class="nav-text"> ç®—æ³•ç®€è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç‰¹ç‚¹-4"><span class="nav-text"> ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†-5"><span class="nav-text"> åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¸¸ç”¨ç®—æ³•-4"><span class="nav-text"> å¸¸ç”¨ç®—æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°-5"><span class="nav-text"> ç®—æ³•å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#dsa-çš„èŒƒä¾‹"><span class="nav-text"> DSA çš„èŒƒä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒèµ„æ–™"><span class="nav-text"> å‚è€ƒèµ„æ–™</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 â€“ <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-paper-plane"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Peng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="ç«™ç‚¹æ€»å­—æ•°">2.1m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">31:25</span>
  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
      
    
  
  <script color="107,97,95" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1.0.0/canvas-nest.min.js"></script>











  



  
  <script src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-reading-progress@1/reading_progress.min.js"></script>


  


  <script src="/blog/js/src/utils.js?v=7.0.1"></script>

  <script src="/blog/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/blog/js/src/schemes/muse.js?v=7.0.1"></script>



  
  <script src="/blog/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/blog/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/blog/js/src/bootstrap.js?v=7.0.1"></script>


  
  


  


  




  

  

  

  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.scrollToMark('auto', "#æ›´å¤š");
  
  </script>


  

</body>
</html>
